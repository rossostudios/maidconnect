# Bun configuration file
# https://bun.sh/docs/runtime/configuration

[install]
# Use exact versions from package.json
exact = true

# Enable production mode for faster installs
production = false

# Configure registry
registry = "https://registry.npmjs.org"

# Auto-install peer dependencies
auto = true

# Configure cache behavior
cache = true

[install.lockfile]
# Save the lockfile
save = true

# Print a message if the lockfile is updated
print = "bun"

[test]
# Test runner configuration
runner = "bun"

# Only run unit tests in src/ directory, exclude E2E and integration tests
root = "./src"

# Code coverage settings
coverage = true
coverageThreshold = { lines = 0.8, functions = 0.8, statements = 0.8, branches = 0.75 }
coverageReporter = ["text", "lcov"]
coverageDir = "./coverage"
coverageSkipTestFiles = true

# Patterns to exclude from test runs
ignore = [
  "**/*.spec.ts",            # Playwright E2E tests (use bun playwright test)
  "**/tests/api/**",         # API integration tests
  "**/tests/playwright/**",  # Playwright E2E tests
  "**/*.stories.tsx",        # Storybook stories
  "**/__mocks__/**",         # Mock files (imported by tests, not run directly)
]

# Patterns to exclude from coverage
coveragePathIgnorePatterns = [
  "**/*.spec.ts",           # Playwright E2E tests
  "**/*.stories.tsx",       # Storybook stories
  "**/__mocks__/**",        # Mock files
  "**/node_modules/**",     # Dependencies
  "**/.next/**",            # Next.js build
  "**/dist/**",             # Build output
  "**/coverage/**",         # Coverage reports
  "**/playwright-report/**", # Playwright reports
  "**/tests/**"             # Test utilities and setup
]

# Global test setup
preload = ["./tests/setup.ts"]

# Test timeout (30 seconds)
timeout = 30000

[run]
# Use Bun's faster JavaScript runtime when available
bun = true

# Shell to use for scripts (only 'bun' and 'system' are supported)
shell = "system"

# Automatically install dependencies when running scripts
autoInstall = false
