"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,29203],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./node_modules/next/dist/client/use-merged-ref.js":(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"useMergedRef",{enumerable:!0,get:function(){return useMergedRef}});const _react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");function useMergedRef(refA,refB){const cleanupA=(0,_react.useRef)(null),cleanupB=(0,_react.useRef)(null);return(0,_react.useCallback)(current=>{if(null===current){const cleanupFnA=cleanupA.current;cleanupFnA&&(cleanupA.current=null,cleanupFnA());const cleanupFnB=cleanupB.current;cleanupFnB&&(cleanupB.current=null,cleanupFnB())}else refA&&(cleanupA.current=applyRef(refA,current)),refB&&(cleanupB.current=applyRef(refB,current))},[refA,refB])}function applyRef(refA,current){if("function"==typeof refA){const cleanup=refA(current);return"function"==typeof cleanup?cleanup:()=>refA(null)}return refA.current=current,()=>{refA.current=null}}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default)},"./src/components/admin/admin-profile-editor.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>admin_profile_editor_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");function AdminProfileEditor({userId:_userId,currentProfile}){const router=(0,navigation.useRouter)(),[isEditing,setIsEditing]=(0,react.useState)(!1),[isSaving,setIsSaving]=(0,react.useState)(!1),[isUploadingAvatar,setIsUploadingAvatar]=(0,react.useState)(!1),[formData,setFormData]=(0,react.useState)(currentProfile),[error,setError]=(0,react.useState)(null),[avatarPreview,setAvatarPreview]=(0,react.useState)(currentProfile.avatar_url||null),fileInputRef=(0,react.useRef)(null);return(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[error&&(0,jsx_runtime.jsx)("div",{className:"rounded-lg border border-slate-900 dark:border-slate-100/30 bg-slate-900 dark:bg-slate-100/10 p-4",children:(0,jsx_runtime.jsx)("p",{className:"text-slate-900 dark:text-slate-100 text-sm",children:error})}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-4 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Profile Photo"}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-6",children:[(0,jsx_runtime.jsxs)("div",{className:"group relative",children:[avatarPreview?(0,jsx_runtime.jsx)(next_image.A,{alt:"Profile photo",className:"h-24 w-24 rounded-full border-2 border-slate-200 dark:border-slate-800 object-cover",height:96,src:avatarPreview,width:96}):(0,jsx_runtime.jsx)("div",{className:"flex h-24 w-24 items-center justify-center rounded-full border-2 border-slate-200 dark:border-slate-800 bg-slate-900 dark:bg-slate-100/10",children:(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-12 w-12 text-slate-900 dark:text-slate-100",icon:index_min.rMq})}),(0,jsx_runtime.jsx)("button",{className:"absolute inset-0 flex items-center justify-center rounded-full bg-[#0f172a]/50 opacity-0 transition-opacity disabled:cursor-not-allowed group-hover:opacity-100",disabled:isUploadingAvatar,onClick:()=>fileInputRef.current?.click(),children:(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-6 w-6 text-white dark:text-slate-950",icon:index_min.eqT})})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 font-medium text-slate-900 dark:text-slate-100 text-sm transition-colors hover:bg-white dark:bg-slate-950 disabled:cursor-not-allowed disabled:opacity-50",disabled:isUploadingAvatar,onClick:()=>fileInputRef.current?.click(),children:isUploadingAvatar?"Uploading...":"Change Photo"}),(0,jsx_runtime.jsx)("p",{className:"mt-2 text-slate-600 dark:text-slate-400 text-xs",children:"JPG, PNG or GIF. Max size 5MB."})]}),(0,jsx_runtime.jsx)("input",{accept:"image/*",className:"hidden",onChange:async e=>{const file=e.target.files?.[0];if(file)if(file.type.startsWith("image/"))if(file.size>5242880)setError("Image size must be less than 5MB");else try{setIsUploadingAvatar(!0),setError(null);const reader=new FileReader;reader.onloadend=()=>{setAvatarPreview(reader.result)},reader.readAsDataURL(file);const formData=new FormData;formData.append("avatar",file);const response=await fetch("/api/admin/profile/avatar",{method:"POST",body:formData});if(!response.ok)throw new Error("Failed to upload avatar");const{avatarUrl}=await response.json();setFormData(prev=>({...prev,avatar_url:avatarUrl})),router.refresh()}catch(err){setError(err instanceof Error?err.message:"Failed to upload avatar"),setAvatarPreview(currentProfile.avatar_url||null)}finally{setIsUploadingAvatar(!1)}else setError("Please select an image file")},ref:fileInputRef,type:"file"})]})]}),(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Full Name"}),isEditing?(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>setFormData({...formData,full_name:e.target.value}),type:"text",value:formData.full_name}):(0,jsx_runtime.jsx)("p",{className:"text-slate-900 dark:text-slate-100",children:currentProfile.full_name||"—"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Email"}),(0,jsx_runtime.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:currentProfile.email}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-slate-600 dark:text-slate-400 text-xs",children:"Email cannot be changed"})]}),(0,jsx_runtime.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Phone"}),isEditing?(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>setFormData({...formData,phone:e.target.value}),type:"tel",value:formData.phone}):(0,jsx_runtime.jsx)("p",{className:"text-slate-900 dark:text-slate-100",children:currentProfile.phone||"—"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"City"}),isEditing?(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>setFormData({...formData,city:e.target.value}),type:"text",value:formData.city}):(0,jsx_runtime.jsx)("p",{className:"text-slate-900 dark:text-slate-100",children:currentProfile.city||"—"})]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Country"}),isEditing?(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>setFormData({...formData,country:e.target.value}),type:"text",value:formData.country}):(0,jsx_runtime.jsx)("p",{className:"text-slate-900 dark:text-slate-100",children:currentProfile.country||"—"})]})]}),(0,jsx_runtime.jsx)("div",{className:"flex items-center gap-3 pt-4",children:isEditing?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-lg bg-slate-900 dark:bg-slate-100 px-6 py-2.5 font-semibold text-sm text-white dark:text-slate-950 transition-colors hover:bg-slate-900 dark:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-50",disabled:isSaving,onClick:async()=>{try{setIsSaving(!0),setError(null);const response=await fetch("/api/admin/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:formData.full_name,phone:formData.phone||void 0,city:formData.city||void 0,country:formData.country||void 0})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||"Failed to update profile")}setIsEditing(!1),router.refresh()}catch(err){console.error("Profile update error:",err),setError(err instanceof Error?err.message:"Failed to update profile")}finally{setIsSaving(!1)}},children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.zQd}),isSaving?"Saving...":"Save Changes"]}),(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-6 py-2.5 font-semibold text-slate-600 dark:text-slate-400 text-sm transition-colors hover:bg-white dark:bg-slate-950 disabled:cursor-not-allowed disabled:opacity-50",disabled:isSaving,onClick:()=>{setFormData(currentProfile),setAvatarPreview(currentProfile.avatar_url||null),setIsEditing(!1),setError(null)},children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.bJi}),"Cancel"]})]}):(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-lg bg-[#0f172a] px-6 py-2.5 font-semibold text-sm text-white dark:text-slate-950 transition-colors hover:bg-[#0f172a]",onClick:()=>setIsEditing(!0),children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.WHm}),"Edit Profile"]})})]})}try{AdminProfileEditor.displayName="AdminProfileEditor",AdminProfileEditor.__docgenInfo={description:"",displayName:"AdminProfileEditor",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}},currentProfile:{defaultValue:null,description:"",name:"currentProfile",required:!0,type:{name:"ProfileData"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/admin/admin-profile-editor.tsx#AdminProfileEditor"]={docgenInfo:AdminProfileEditor.__docgenInfo,name:"AdminProfileEditor",path:"src/components/admin/admin-profile-editor.tsx#AdminProfileEditor"})}catch(__react_docgen_typescript_loader_error){}const admin_profile_editor_stories={title:"Admin/Admin Profile Editor",component:AdminProfileEditor,parameters:{layout:"centered"},tags:["autodocs"]},Default={args:{}},__namedExportsOrder=["Default"]}}]);