"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[43184],{"./node_modules/@sanity/client/dist/_chunks-es/stegaEncodeSourceMap.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{stegaEncodeSourceMap$1:()=>stegaEncodeSourceMap$1});var _stegaClean_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@sanity/client/dist/_chunks-es/stegaClean.js");const reKeySegment=/_key\s*==\s*['"](.*)['"]/;function toString(path){if(!Array.isArray(path))throw new Error("Path is not an array");return path.reduce((target,segment,i)=>{const segmentType=typeof segment;if("number"===segmentType)return`${target}[${segment}]`;if("string"===segmentType)return`${target}${0===i?"":"."}${segment}`;if(function isKeySegment(segment){return"string"==typeof segment?reKeySegment.test(segment.trim()):"object"==typeof segment&&"_key"in segment}(segment)&&segment._key)return`${target}[_key=="${segment._key}"]`;if(Array.isArray(segment)){const[from,to]=segment;return`${target}[${from}:${to}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(segment)}\``)},"")}const ESCAPE={"\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","'":"\\'","\\":"\\\\"},UNESCAPE={"\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t","\\'":"'","\\\\":"\\"};function parseJsonPath(path){const parsed=[],parseRe=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let match;for(;null!==(match=parseRe.exec(path));){if(void 0!==match[1]){const key=match[1].replace(/\\(\\|f|n|r|t|')/g,m=>UNESCAPE[m]);parsed.push(key);continue}if(void 0===match[2]){if(void 0!==match[3]){const _key=match[3].replace(/\\(\\')/g,m=>UNESCAPE[m]);parsed.push({_key,_index:-1});continue}}else parsed.push(parseInt(match[2],10))}return parsed}function jsonPathToStudioPath(path){return path.map(segment=>{if("string"==typeof segment||"number"==typeof segment)return segment;if(""!==segment._key)return{_key:segment._key};if(-1!==segment._index)return segment._index;throw new Error(`invalid segment:${JSON.stringify(segment)}`)})}function resolveMapping(resultPath,csm){if(!csm?.mappings)return;const resultMappingPath=function jsonPath(path){return`$${path.map(segment=>"string"==typeof segment?`['${segment.replace(/[\f\n\r\t'\\]/g,match=>ESCAPE[match])}']`:"number"==typeof segment?`[${segment}]`:""!==segment._key?`[?(@._key=='${segment._key.replace(/['\\]/g,match=>ESCAPE[match])}')]`:`[${segment._index}]`).join("")}`}(function jsonPathToMappingPath(path){return path.map(segment=>{if("string"==typeof segment||"number"==typeof segment)return segment;if(-1!==segment._index)return segment._index;throw new Error(`invalid segment:${JSON.stringify(segment)}`)})}(resultPath));if(void 0!==csm.mappings[resultMappingPath])return{mapping:csm.mappings[resultMappingPath],matchedPath:resultMappingPath,pathSuffix:""};const mappings=Object.entries(csm.mappings).filter(([key])=>resultMappingPath.startsWith(key)).sort(([key1],[key2])=>key2.length-key1.length);if(0==mappings.length)return;const[matchedPath,mapping]=mappings[0];return{mapping,matchedPath,pathSuffix:resultMappingPath.substring(matchedPath.length)}}function walkMap(value,mappingFn,path=[]){if(function isArray(value){return null!==value&&Array.isArray(value)}(value))return value.map((v,idx)=>{if((0,_stegaClean_js__WEBPACK_IMPORTED_MODULE_0__.u4)(v)){const _key=v._key;if("string"==typeof _key)return walkMap(v,mappingFn,path.concat({_key,_index:idx}))}return walkMap(v,mappingFn,path.concat(idx))});if((0,_stegaClean_js__WEBPACK_IMPORTED_MODULE_0__.u4)(value)){if("block"===value._type||"span"===value._type){const result={...value};return"block"===value._type?result.children=walkMap(value.children,mappingFn,path.concat("children")):"span"===value._type&&(result.text=walkMap(value.text,mappingFn,path.concat("text"))),result}return Object.fromEntries(Object.entries(value).map(([k,v])=>[k,walkMap(v,mappingFn,path.concat(k))]))}return mappingFn(value,path)}function isDraftId(id){return id.startsWith("drafts.")}function isVersionId(id){return id.startsWith("versions.")}function createEditUrl(options){const{baseUrl,workspace:_workspace="default",tool:_tool="default",id:_id,type,path,projectId,dataset}=options;if(!baseUrl)throw new Error("baseUrl is required");if(!path)throw new Error("path is required");if(!_id)throw new Error("id is required");if("/"!==baseUrl&&baseUrl.endsWith("/"))throw new Error("baseUrl must not end with a slash");const workspace="default"===_workspace?void 0:_workspace,tool="default"===_tool?void 0:_tool,id=function getPublishedId(id){return isVersionId(id)?id.split(".").slice(2).join("."):isDraftId(id)?id.slice(7):id}(_id),stringifiedPath=Array.isArray(path)?toString(jsonPathToStudioPath(path)):path,searchParams=new URLSearchParams({baseUrl,id,type,path:stringifiedPath});if(workspace&&searchParams.set("workspace",workspace),tool&&searchParams.set("tool",tool),projectId&&searchParams.set("projectId",projectId),dataset&&searchParams.set("dataset",dataset),function isPublishedId(id){return!isDraftId(id)&&!isVersionId(id)}(_id))searchParams.set("perspective","published");else if(isVersionId(_id)){const versionId=function getVersionFromId(id){if(!isVersionId(id))return;const[_versionPrefix,versionId,..._publishedId]=id.split(".");return versionId}(_id);searchParams.set("perspective",versionId)}const segments=["/"===baseUrl?"":baseUrl];workspace&&segments.push(workspace);const routerParams=["mode=presentation",`id=${id}`,`type=${type}`,`path=${encodeURIComponent(stringifiedPath)}`];return tool&&routerParams.push(`tool=${tool}`),segments.push("intent","edit",`${routerParams.join(";")}?${searchParams}`),segments.join("/")}const filterDefault=({sourcePath,resultPath,value})=>{if(function isValidDate(dateString){return!!/^\d{4}-\d{2}-\d{2}/.test(dateString)&&!!Date.parse(dateString)}(value)||function isValidURL(url){try{const{protocol}=new URL(url,url.startsWith("/")?"https://acme.com":void 0);return allowedProtocols.has(protocol)||protocol.startsWith("web+")}catch{return!1}}(value))return!1;const endPath=sourcePath.at(-1);return!("slug"===sourcePath.at(-2)&&"current"===endPath||"string"==typeof endPath&&(endPath.startsWith("_")||endPath.endsWith("Id"))||sourcePath.some(path=>"meta"===path||"metadata"===path||"openGraph"===path||"seo"===path)||hasTypeLike(sourcePath)||hasTypeLike(resultPath)||"string"==typeof endPath&&denylist.has(endPath))},denylist=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]);const allowedProtocols=new Set(["app:","data:","discord:","file:","ftp:","ftps:","geo:","http:","https:","imap:","javascript:","magnet:","mailto:","maps:","ms-excel:","ms-powerpoint:","ms-word:","slack:","sms:","spotify:","steam:","teams:","tel:","vscode:","zoom:"]);function hasTypeLike(path){return path.some(segment=>"string"==typeof segment&&null!==segment.match(/type/i))}function prettyPathForLogging(path){return toString(jsonPathToStudioPath(path))}var stegaEncodeSourceMap$1=Object.freeze({__proto__:null,stegaEncodeSourceMap:function stegaEncodeSourceMap(result,resultSourceMap,config){const{filter,logger,enabled}=config;if(!enabled){const msg="config.enabled must be true, don't call this function otherwise";throw logger?.error?.(`[@sanity/client]: ${msg}`,{result,resultSourceMap,config}),new TypeError(msg)}if(!resultSourceMap)return logger?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result,resultSourceMap,config}),result;if(!config.studioUrl){const msg="config.studioUrl must be defined";throw logger?.error?.(`[@sanity/client]: ${msg}`,{result,resultSourceMap,config}),new TypeError(msg)}const report={encoded:[],skipped:[]},resultWithStega=function encodeIntoResult(result,csm,encoder){return walkMap(result,(value,path)=>{if("string"!=typeof value)return value;const resolveMappingResult=resolveMapping(path,csm);if(!resolveMappingResult)return value;const{mapping,matchedPath}=resolveMappingResult;if("value"!==mapping.type||"documentValue"!==mapping.source.type)return value;const sourceDocument=csm.documents[mapping.source.document],sourcePath=csm.paths[mapping.source.path],matchPathSegments=parseJsonPath(matchedPath),fullSourceSegments=parseJsonPath(sourcePath).concat(path.slice(matchPathSegments.length));return encoder({sourcePath:fullSourceSegments,sourceDocument,resultPath:path,value})})}(result,resultSourceMap,({sourcePath,sourceDocument,resultPath,value})=>{if(!1===("function"==typeof filter?filter({sourcePath,resultPath,filterDefault,sourceDocument,value}):filterDefault({sourcePath,resultPath,value})))return logger&&report.skipped.push({path:prettyPathForLogging(sourcePath),value:`${value.slice(0,20)}${value.length>20?"...":""}`,length:value.length}),value;logger&&report.encoded.push({path:prettyPathForLogging(sourcePath),value:`${value.slice(0,20)}${value.length>20?"...":""}`,length:value.length});const{baseUrl,workspace,tool}=function resolveStudioBaseRoute(studioUrl){let baseUrl="string"==typeof studioUrl?studioUrl:studioUrl.baseUrl;return"/"!==baseUrl&&(baseUrl=baseUrl.replace(/\/$/,"")),"string"==typeof studioUrl?{baseUrl}:{...studioUrl,baseUrl}}("function"==typeof config.studioUrl?config.studioUrl(sourceDocument):config.studioUrl);if(!baseUrl)return value;const{_id:id,_type:type,_projectId:projectId,_dataset:dataset}=sourceDocument;return(0,_stegaClean_js__WEBPACK_IMPORTED_MODULE_0__.C)(value,{origin:"sanity.io",href:createEditUrl({baseUrl,workspace,tool,id,type,path:sourcePath,...!config.omitCrossDatasetReferenceData&&{dataset,projectId}})},!1)});if(logger){const isSkipping=report.skipped.length,isEncoding=report.encoded.length;if((isSkipping||isEncoding)&&((logger?.groupCollapsed||logger.log)?.("[@sanity/client]: Encoding source map into result"),logger.log?.(`[@sanity/client]: Paths encoded: ${report.encoded.length}, skipped: ${report.skipped.length}`)),report.encoded.length>0&&(logger?.log?.("[@sanity/client]: Table of encoded paths"),(logger?.table||logger.log)?.(report.encoded)),report.skipped.length>0){const skipped=new Set;for(const{path}of report.skipped)skipped.add(path.replace(reKeySegment,"0").replace(/\[\d+\]/g,"[]"));logger?.log?.("[@sanity/client]: List of skipped paths",[...skipped.values()])}(isSkipping||isEncoding)&&logger?.groupEnd?.()}return resultWithStega}})}}]);