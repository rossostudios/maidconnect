/*! For license information please see components-bookings-arrival-window-tracker-stories.b91013cc.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[87842],{"./node_modules/class-variance-authority/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>cva});var clsx__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/clsx/dist/clsx.mjs");const falsyToString=value=>"boolean"==typeof value?`${value}`:0===value?"0":value,cx=clsx__WEBPACK_IMPORTED_MODULE_0__.$,cva=(base,config)=>props=>{var _config_compoundVariants;if(null==(null==config?void 0:config.variants))return cx(base,null==props?void 0:props.class,null==props?void 0:props.className);const{variants,defaultVariants}=config,getVariantClassNames=Object.keys(variants).map(variant=>{const variantProp=null==props?void 0:props[variant],defaultVariantProp=null==defaultVariants?void 0:defaultVariants[variant];if(null===variantProp)return null;const variantKey=falsyToString(variantProp)||falsyToString(defaultVariantProp);return variants[variant][variantKey]}),propsWithoutUndefined=props&&Object.entries(props).reduce((acc,param)=>{let[key,value]=param;return void 0===value||(acc[key]=value),acc},{}),getCompoundVariantClassNames=null==config||null===(_config_compoundVariants=config.compoundVariants)||void 0===_config_compoundVariants?void 0:_config_compoundVariants.reduce((acc,param)=>{let{class:cvClass,className:cvClassName,...compoundVariantOptions}=param;return Object.entries(compoundVariantOptions).every(param=>{let[key,value]=param;return Array.isArray(value)?value.includes({...defaultVariants,...propsWithoutUndefined}[key]):{...defaultVariants,...propsWithoutUndefined}[key]===value})?[...acc,cvClass,cvClassName]:acc},[]);return cx(base,getVariantClassNames,getCompoundVariantClassNames,null==props?void 0:props.class,null==props?void 0:props.className)}},"./node_modules/clsx/dist/clsx.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f)}else for(f in e)e[f]&&(n&&(n+=" "),n+=f);return n}function clsx(){for(var e,t,f=0,n="",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}__webpack_require__.d(__webpack_exports__,{$:()=>clsx})},"./node_modules/lucide-react/dist/esm/createLucideIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>createLucideIcon});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const toPascalCase=string=>{const camelCase=(string=>string.replace(/^([A-Z])|[\s-_]+(\w)/g,(match,p1,p2)=>p2?p2.toUpperCase():p1.toLowerCase()))(string);return camelCase.charAt(0).toUpperCase()+camelCase.slice(1)},mergeClasses=(...classes)=>classes.filter((className,index,array)=>Boolean(className)&&""!==className.trim()&&array.indexOf(className)===index).join(" ").trim(),hasA11yProp=props=>{for(const prop in props)if(prop.startsWith("aria-")||"role"===prop||"title"===prop)return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=(0,react.forwardRef)(({color="currentColor",size=24,strokeWidth=2,absoluteStrokeWidth,className="",children,iconNode,...rest},ref)=>(0,react.createElement)("svg",{ref,...defaultAttributes,width:size,height:size,stroke:color,strokeWidth:absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth,className:mergeClasses("lucide",className),...!children&&!hasA11yProp(rest)&&{"aria-hidden":"true"},...rest},[...iconNode.map(([tag,attrs])=>(0,react.createElement)(tag,attrs)),...Array.isArray(children)?children:[children]])),createLucideIcon=(iconName,iconNode)=>{const Component=(0,react.forwardRef)(({className,...props},ref)=>{return(0,react.createElement)(Icon,{ref,iconNode,className:mergeClasses(`lucide-${string=toPascalCase(iconName),string.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${iconName}`,className),...props});var string});return Component.displayName=toPascalCase(iconName),Component}},"./node_modules/next-intl/dist/esm/production/react-client/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c3:()=>e});var use_intl__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/use-intl/dist/esm/production/react.js");function o(r,t){return(...r)=>{try{return t(...r)}catch{throw new Error(void 0)}}}const e=o(0,use_intl__WEBPACK_IMPORTED_MODULE_0__.c3);o(0,use_intl__WEBPACK_IMPORTED_MODULE_0__.kc)},"./src/components/bookings/arrival-window-tracker.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>arrival_window_tracker_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),createLucideIcon=__webpack_require__("./node_modules/lucide-react/dist/esm/createLucideIcon.js");const Navigation=(0,createLucideIcon.A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),MapPin=(0,createLucideIcon.A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Clock=(0,createLucideIcon.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var react_client=__webpack_require__("./node_modules/next-intl/dist/esm/production/react-client/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),card=__webpack_require__("./src/components/ui/card.tsx"),utils=__webpack_require__("./src/lib/utils.ts"),feature_flags=__webpack_require__("./src/lib/feature-flags.ts");function ArrivalWindowTracker({bookingId,professionalName,scheduledStart,status,className}){const t=(0,react_client.c3)("bookings.arrivalTracker"),[arrivalWindow,setArrivalWindow]=(0,react.useState)(null),[isLoading,setIsLoading]=(0,react.useState)(!0),featureEnabled=(0,feature_flags.G7)("arrival_notifications"),scheduledTime=new Date(scheduledStart),now=new Date,isPast=scheduledTime<now,isCompleted=["completed","canceled","declined"].includes(status);if((0,react.useEffect)(()=>{if(!featureEnabled||isPast||isCompleted)return void setIsLoading(!1);async function fetchArrivalWindow(){try{const response=await fetch(`/api/notifications/arrival-alert?bookingId=${bookingId}`);if(!response.ok)return setArrivalWindow(null),void setIsLoading(!1);const data=await response.json();setArrivalWindow(data.arrivalWindow||null),setIsLoading(!1)}catch(_error){setArrivalWindow(null),setIsLoading(!1)}}fetchArrivalWindow();const pollInterval=setInterval(()=>{fetchArrivalWindow()},12e4);return()=>clearInterval(pollInterval)},[bookingId,featureEnabled,isPast,isCompleted]),!featureEnabled||isLoading||!arrivalWindow||"scheduled"===arrivalWindow.status||"in_progress"===arrivalWindow.status)return null;const config={en_route:{icon:Navigation,title:t("status.enRoute.title",{name:professionalName}),description:t("status.enRoute.description"),variant:"secondary"},arriving_soon:{icon:MapPin,title:t("status.arrivingSoon.title",{name:professionalName}),description:t("status.arrivingSoon.description"),variant:"default"},arrived:{icon:MapPin,title:t("status.arrived.title",{name:professionalName}),description:t("status.arrived.description"),variant:"default"},scheduled:{icon:Clock,title:"",description:"",variant:"outline"},in_progress:{icon:Clock,title:"",description:"",variant:"outline"}}[arrivalWindow.status],Icon=config.icon;let timeDisplay="";if(arrivalWindow.windowStart&&arrivalWindow.windowEnd){timeDisplay=t("timeWindow",{start:new Date(arrivalWindow.windowStart).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}),end:new Date(arrivalWindow.windowEnd).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})}else if(arrivalWindow.estimatedArrival){timeDisplay=t("estimatedArrival",{time:new Date(arrivalWindow.estimatedArrival).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})}let lastUpdateDisplay="";if(arrivalWindow.lastUpdate){const updateTime=new Date(arrivalWindow.lastUpdate),minutesAgo=Math.floor((now.getTime()-updateTime.getTime())/6e4);lastUpdateDisplay=minutesAgo<1?t("updatedJustNow"):1===minutesAgo?t("updatedMinuteAgo"):t("updatedMinutesAgo",{minutes:minutesAgo})}return(0,jsx_runtime.jsx)(card.Zp,{className:(0,utils.cn)("border-2 shadow-sm",className),children:(0,jsx_runtime.jsxs)(card.Wu,{className:"p-6",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start gap-4",children:[(0,jsx_runtime.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-slate-100",children:(0,jsx_runtime.jsx)(Icon,{className:"h-6 w-6 text-slate-700"})}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:config.title}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-base text-slate-600",children:config.description})]}),timeDisplay&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-base text-slate-700",children:[(0,jsx_runtime.jsx)(Clock,{className:"h-4 w-4"}),(0,jsx_runtime.jsx)("span",{className:"font-medium",children:timeDisplay})]}),lastUpdateDisplay&&(0,jsx_runtime.jsx)("p",{className:"text-sm text-slate-500",children:lastUpdateDisplay})]}),"arriving_soon"===arrivalWindow.status&&(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)("div",{className:"absolute h-3 w-3 animate-ping rounded-full bg-slate-400 opacity-75"}),(0,jsx_runtime.jsx)("div",{className:"relative h-3 w-3 rounded-full bg-slate-500"})]})]}),(0,jsx_runtime.jsx)("div",{className:"mt-4 rounded-lg border border-slate-200 bg-slate-50 p-3",children:(0,jsx_runtime.jsx)("p",{className:"text-xs text-slate-600",children:t("privacyNotice")})})]})})}try{ArrivalWindowTracker.displayName="ArrivalWindowTracker",ArrivalWindowTracker.__docgenInfo={description:"Arrival Window Tracker Component\n\nPrivacy-conscious arrival tracking that shows customers when their professional\nis nearby without revealing precise location data.\n\nFeatures:\n- 30-minute arrival window (optimal per research)\n- Progressive status updates (en route → arriving soon → arrived)\n- Real-time polling during active arrival window\n- Auto-dismisses after service starts",displayName:"ArrivalWindowTracker",props:{bookingId:{defaultValue:null,description:"",name:"bookingId",required:!0,type:{name:"string"}},professionalName:{defaultValue:null,description:"",name:"professionalName",required:!0,type:{name:"string"}},scheduledStart:{defaultValue:null,description:"",name:"scheduledStart",required:!0,type:{name:"string"}},status:{defaultValue:null,description:"",name:"status",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/bookings/arrival-window-tracker.tsx#ArrivalWindowTracker"]={docgenInfo:ArrivalWindowTracker.__docgenInfo,name:"ArrivalWindowTracker",path:"src/components/bookings/arrival-window-tracker.tsx#ArrivalWindowTracker"})}catch(__react_docgen_typescript_loader_error){}const arrival_window_tracker_stories={title:"Bookings/ArrivalWindowTracker",component:ArrivalWindowTracker,parameters:{layout:"padded"},tags:["autodocs"]},Default={},__namedExportsOrder=["Default"]},"./src/components/ui/card.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Zp:()=>Card,Wu:()=>CardContent,wL:()=>CardFooter,aR:()=>CardHeader,MH:()=>CardImage});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),proxy=__webpack_require__("./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs"),dist=__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs");const cardHover={rest:{scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25}},hover:{scale:1.01,y:-2,transition:{type:"spring",stiffness:400,damping:25}}};var utils=__webpack_require__("./src/lib/utils.ts");const cardVariants=(0,dist.F)("rounded-lg overflow-hidden transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900",{variants:{variant:{default:"bg-white ring-1 ring-black/5 shadow-sm dark:bg-neutral-900 dark:ring-white/10",elevated:"bg-white ring-1 ring-black/5 shadow-md dark:bg-neutral-900 dark:ring-white/10",outlined:"bg-white ring-1 ring-black/8 shadow-none dark:bg-neutral-900 dark:ring-white/12",glass:"bg-white/70 ring-1 ring-black/5 shadow-sm backdrop-blur-lg dark:bg-neutral-900/70 dark:ring-white/10"}},defaultVariants:{variant:"default"}}),Card=({variant="default",hoverable=!1,asButton=!1,href,disableMotion=!1,className,children,ref,...props})=>{const classes=(0,utils.cn)(cardVariants({variant}),(hoverable||href||asButton)&&"cursor-pointer",className),motionVariants=hoverable&&!disableMotion?{initial:"rest",whileHover:"hover",variants:cardHover,style:{willChange:"transform"}}:{};return href?(0,jsx_runtime.jsx)(proxy.P.a,{className:classes,href,ref,...motionVariants,children}):asButton?(0,jsx_runtime.jsx)(proxy.P.button,{className:classes,ref,type:"button",...motionVariants,children}):disableMotion?(0,jsx_runtime.jsx)("div",{className:classes,ref,...props,children}):(0,jsx_runtime.jsx)(proxy.P.div,{className:classes,ref,...motionVariants,children})};Card.displayName="Card";const CardHeader=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pb-4",className),ref,...props});CardHeader.displayName="CardHeader";const CardContent=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pt-0",className),ref,...props});CardContent.displayName="CardContent";const CardFooter=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("border-t border-black/5 p-6 pt-4 dark:border-white/10",className),ref,...props});CardFooter.displayName="CardFooter";const CardImage=({aspectRatio="16/9",className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("relative overflow-hidden",className),ref,style:{aspectRatio},...props});CardImage.displayName="CardImage";try{Card.displayName="Card",Card.__docgenInfo={description:"Card - Flexible container with optional animations",displayName:"Card",props:{variant:{defaultValue:{value:"default"},description:"Visual variant",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"elevated"'},{value:'"outlined"'},{value:'"glass"'}]}},hoverable:{defaultValue:{value:"false"},description:"Enable hover lift effect",name:"hoverable",required:!1,type:{name:"boolean"}},asButton:{defaultValue:{value:"false"},description:"Clickable card (renders as button)",name:"asButton",required:!1,type:{name:"boolean"}},href:{defaultValue:null,description:"Link href (renders as anchor)",name:"href",required:!1,type:{name:"string"}},disableMotion:{defaultValue:{value:"false"},description:"Disable motion animations",name:"disableMotion",required:!1,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#Card"]={docgenInfo:Card.__docgenInfo,name:"Card",path:"src/components/ui/card.tsx#Card"})}catch(__react_docgen_typescript_loader_error){}try{CardHeader.displayName="CardHeader",CardHeader.__docgenInfo={description:"CardHeader - Card header section",displayName:"CardHeader",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardHeader"]={docgenInfo:CardHeader.__docgenInfo,name:"CardHeader",path:"src/components/ui/card.tsx#CardHeader"})}catch(__react_docgen_typescript_loader_error){}try{CardContent.displayName="CardContent",CardContent.__docgenInfo={description:"CardContent - Card main content section",displayName:"CardContent",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardContent"]={docgenInfo:CardContent.__docgenInfo,name:"CardContent",path:"src/components/ui/card.tsx#CardContent"})}catch(__react_docgen_typescript_loader_error){}try{CardFooter.displayName="CardFooter",CardFooter.__docgenInfo={description:"CardFooter - Card footer section",displayName:"CardFooter",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardFooter"]={docgenInfo:CardFooter.__docgenInfo,name:"CardFooter",path:"src/components/ui/card.tsx#CardFooter"})}catch(__react_docgen_typescript_loader_error){}try{CardImage.displayName="CardImage",CardImage.__docgenInfo={description:"CardImage - Card image section",displayName:"CardImage",props:{aspectRatio:{defaultValue:{value:"16/9"},description:"",name:"aspectRatio",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardImage"]={docgenInfo:CardImage.__docgenInfo,name:"CardImage",path:"src/components/ui/card.tsx#CardImage"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/feature-flags.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G7:()=>isFeatureEnabled});var process=__webpack_require__("./node_modules/process/browser.js");const defaultFlags={show_match_wizard:!0,enable_web_vitals:!1,enhanced_trust_badges:!1,live_price_breakdown:!1,show_on_time_metrics:!1,auto_translate_chat:!0,one_tap_rebook:!0,recurring_plans:!0,rebook_nudge_system:!0,gps_check_in_out:!0,arrival_notifications:!0,time_extension_ui:!0,show_amara_assistant:!0,admin_verification_queue:!0,payout_ledger:!1,city_landing_pages:!0,show_platform_fee:!1,enable_tipping:!0,subscription_discount_badges:!1,caregiver_profiles:!1,maintenance_reminders:!1,referral_program:!0};function isFeatureEnabled(flag,userId){const envOverride=function getEnvOverride(flag){const envKey=`NEXT_PUBLIC_FEATURE_${flag.toUpperCase()}`,envValue=process.env[envKey];if(void 0!==envValue)return"true"===envValue||"1"===envValue}(flag);return void 0!==envOverride?envOverride:!(!userId||!function isBetaTester(userId,flag){const betaTesters={show_match_wizard:[],recurring_plans:[]};return betaTesters[flag]?.includes(userId)??!1}(userId,flag))||defaultFlags[flag]}},"./src/lib/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function cn(...classes){return classes.filter(Boolean).join(" ")}__webpack_require__.d(__webpack_exports__,{cn:()=>cn})}}]);