"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[85988],{"./node_modules/class-variance-authority/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>cva});var clsx__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/clsx/dist/clsx.mjs");const falsyToString=value=>"boolean"==typeof value?`${value}`:0===value?"0":value,cx=clsx__WEBPACK_IMPORTED_MODULE_0__.$,cva=(base,config)=>props=>{var _config_compoundVariants;if(null==(null==config?void 0:config.variants))return cx(base,null==props?void 0:props.class,null==props?void 0:props.className);const{variants,defaultVariants}=config,getVariantClassNames=Object.keys(variants).map(variant=>{const variantProp=null==props?void 0:props[variant],defaultVariantProp=null==defaultVariants?void 0:defaultVariants[variant];if(null===variantProp)return null;const variantKey=falsyToString(variantProp)||falsyToString(defaultVariantProp);return variants[variant][variantKey]}),propsWithoutUndefined=props&&Object.entries(props).reduce((acc,param)=>{let[key,value]=param;return void 0===value||(acc[key]=value),acc},{}),getCompoundVariantClassNames=null==config||null===(_config_compoundVariants=config.compoundVariants)||void 0===_config_compoundVariants?void 0:_config_compoundVariants.reduce((acc,param)=>{let{class:cvClass,className:cvClassName,...compoundVariantOptions}=param;return Object.entries(compoundVariantOptions).every(param=>{let[key,value]=param;return Array.isArray(value)?value.includes({...defaultVariants,...propsWithoutUndefined}[key]):{...defaultVariants,...propsWithoutUndefined}[key]===value})?[...acc,cvClass,cvClassName]:acc},[]);return cx(base,getVariantClassNames,getCompoundVariantClassNames,null==props?void 0:props.class,null==props?void 0:props.className)}},"./node_modules/clsx/dist/clsx.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function r(e){var t,f,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=" "),n+=f)}else for(f in e)e[f]&&(n&&(n+=" "),n+=f);return n}function clsx(){for(var e,t,f=0,n="",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=" "),n+=t);return n}__webpack_require__.d(__webpack_exports__,{$:()=>clsx})},"./src/components/payments/payment-authorization-card.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ExistingPaymentMethod:()=>ExistingPaymentMethod,NewPaymentMethod:()=>NewPaymentMethod,__namedExportsOrder:()=>__namedExportsOrder,default:()=>payment_authorization_card_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react_stripe_esm=__webpack_require__("./node_modules/@stripe/react-stripe-js/dist/react-stripe.esm.mjs"),lib=__webpack_require__("./node_modules/@stripe/stripe-js/lib/index.mjs"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),card=__webpack_require__("./src/components/ui/card.tsx"),utils=__webpack_require__("./src/lib/utils.ts");function PaymentAuthorizationCard({hasPaymentMethod}){const publishableKey="pk_test_51SDBpLRrYE86buw0Z6tsJBCLyWwQ4ZEGU0Is422C6iXlRsY9eheTM9ZIL5TxItOJ46GzWxGxAXI0QAx0p7ipO9QH00JWbdLFxN",stripePromise=(0,react.useMemo)(()=>publishableKey?(0,lib.c)(publishableKey):null,[publishableKey]),[clientSecret,setClientSecret]=(0,react.useState)(null),[status,setStatus]=(0,react.useState)(hasPaymentMethod?"success":"idle"),[message,setMessage]=(0,react.useState)(null),appearance=(0,react.useMemo)(()=>({theme:"flat",variables:{colorPrimary:"#0f172a",colorText:"#1e293b",colorBackground:"#ffffff",borderRadius:"12px"}}),[]),handleStart=(0,react.useCallback)(async()=>{setStatus("loading"),setMessage(null);try{const response=await fetch("/api/payments/create-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:5e4,currency:"cop"})});if(!response.ok){const body=await response.json().catch(()=>({}));throw new Error(body.error??"Unable to start payment")}const body=await response.json();setClientSecret(body.clientSecret),setStatus("idle")}catch(error){setStatus("error"),setMessage(error instanceof Error?error.message:"Something went wrong. Please try again.")}},[]);return stripePromise?clientSecret?(0,jsx_runtime.jsxs)(react_stripe_esm.S8,{options:{clientSecret,appearance},stripe:stripePromise,children:[(0,jsx_runtime.jsx)(PaymentForm,{onError:setMessage,onSuccess:()=>setStatus("success"),reset:()=>setClientSecret(null)}),message?(0,jsx_runtime.jsx)("p",{className:"mt-2 text-red-600 text-xs",children:message}):null]}):(0,jsx_runtime.jsxs)("div",{className:"mt-4 flex flex-col gap-3",children:["success"===status?(0,jsx_runtime.jsx)("p",{className:"text-green-700 text-sm",children:"Payment method on file. You can update it anytime."}):(0,jsx_runtime.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed",children:"We'll authorize a small amount (COP $50,000) to keep your payment method on file. You're only charged after a service is completed."}),message?(0,jsx_runtime.jsx)("p",{className:"text-red-600 text-sm",children:message}):null,(0,jsx_runtime.jsx)("button",{className:(0,utils.cn)("inline-flex w-fit items-center justify-center rounded-full px-6 py-3 font-semibold text-base transition","bg-slate-900 text-white shadow-lg hover:bg-slate-800","disabled:cursor-not-allowed disabled:opacity-70"),disabled:"loading"===status,onClick:handleStart,type:"button",children:"loading"===status?"Preparing…":hasPaymentMethod?"Update payment method":"Add payment method"})]}):(0,jsx_runtime.jsx)(card.Zp,{className:"mt-4 border-red-200 bg-red-50",children:(0,jsx_runtime.jsx)(card.Wu,{className:"px-4 py-3 text-red-800 text-sm",children:"Stripe publishable key is not configured."})})}function PaymentForm({onSuccess,onError,reset}){const stripe=(0,react_stripe_esm.t2)(),elements=(0,react_stripe_esm.HH)(),router=(0,navigation.useRouter)(),[isSubmitting,setIsSubmitting]=(0,react.useState)(!1),handleSubmit=(0,react.useCallback)(async()=>{if(stripe&&elements){setIsSubmitting(!0),onError(null);try{const{error,paymentIntent}=await stripe.confirmPayment({elements,confirmParams:{return_url:window.location.origin},redirect:"if_required"});if(error)throw new Error(error.message??"Payment could not be confirmed.");if("requires_capture"!==paymentIntent?.status&&"succeeded"!==paymentIntent?.status)throw new Error("Payment is still pending. Please try again.");onSuccess(),reset(),router.refresh()}catch(error){onError(error instanceof Error?error.message:"Unexpected error confirming payment.")}finally{setIsSubmitting(!1)}}},[stripe,elements,onError,onSuccess,reset,router]);return(0,jsx_runtime.jsx)(card.Zp,{className:"mt-4 border-slate-200 bg-white shadow-sm",children:(0,jsx_runtime.jsxs)(card.Wu,{className:"space-y-4 p-6",children:[(0,jsx_runtime.jsx)(react_stripe_esm.He,{options:{layout:"tabs"}}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-3",children:[(0,jsx_runtime.jsx)("button",{className:(0,utils.cn)("inline-flex items-center justify-center rounded-full px-6 py-3 font-semibold text-base transition","bg-slate-900 text-white shadow-lg hover:bg-slate-800","disabled:cursor-not-allowed disabled:opacity-70"),disabled:isSubmitting,onClick:handleSubmit,type:"button",children:isSubmitting?"Authorizing…":"Authorize"}),(0,jsx_runtime.jsx)("button",{className:(0,utils.cn)("inline-flex items-center justify-center rounded-full border-2 px-6 py-3 font-semibold text-base transition","border-slate-300 text-slate-700 hover:border-slate-400 hover:text-slate-900","disabled:cursor-not-allowed disabled:opacity-70"),disabled:isSubmitting,onClick:reset,type:"button",children:"Cancel"})]}),(0,jsx_runtime.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed",children:"You'll only be charged after the service is completed. Authorizations expire automatically if unused."})]})})}try{PaymentAuthorizationCard.displayName="PaymentAuthorizationCard",PaymentAuthorizationCard.__docgenInfo={description:"",displayName:"PaymentAuthorizationCard",props:{hasPaymentMethod:{defaultValue:null,description:"",name:"hasPaymentMethod",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/payments/payment-authorization-card.tsx#PaymentAuthorizationCard"]={docgenInfo:PaymentAuthorizationCard.__docgenInfo,name:"PaymentAuthorizationCard",path:"src/components/payments/payment-authorization-card.tsx#PaymentAuthorizationCard"})}catch(__react_docgen_typescript_loader_error){}const payment_authorization_card_stories={title:"Payments/PaymentAuthorizationCard",component:PaymentAuthorizationCard,parameters:{layout:"padded",docs:{description:{component:"Stripe payment method authorization card for capturing payment details before service delivery."}}},tags:["autodocs"],argTypes:{hasPaymentMethod:{control:"boolean",description:"Whether user already has a payment method on file"}}},NewPaymentMethod={args:{hasPaymentMethod:!1}},ExistingPaymentMethod={args:{hasPaymentMethod:!0}},__namedExportsOrder=["NewPaymentMethod","ExistingPaymentMethod"]},"./src/components/ui/card.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Zp:()=>Card,Wu:()=>CardContent,wL:()=>CardFooter,aR:()=>CardHeader,MH:()=>CardImage});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),proxy=__webpack_require__("./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs"),dist=__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs");const cardHover={rest:{scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25}},hover:{scale:1.01,y:-2,transition:{type:"spring",stiffness:400,damping:25}}};var utils=__webpack_require__("./src/lib/utils.ts");const cardVariants=(0,dist.F)("rounded-lg overflow-hidden transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900",{variants:{variant:{default:"bg-white ring-1 ring-black/5 shadow-sm dark:bg-neutral-900 dark:ring-white/10",elevated:"bg-white ring-1 ring-black/5 shadow-md dark:bg-neutral-900 dark:ring-white/10",outlined:"bg-white ring-1 ring-black/8 shadow-none dark:bg-neutral-900 dark:ring-white/12",glass:"bg-white/70 ring-1 ring-black/5 shadow-sm backdrop-blur-lg dark:bg-neutral-900/70 dark:ring-white/10"}},defaultVariants:{variant:"default"}}),Card=({variant="default",hoverable=!1,asButton=!1,href,disableMotion=!1,className,children,ref,...props})=>{const classes=(0,utils.cn)(cardVariants({variant}),(hoverable||href||asButton)&&"cursor-pointer",className),motionVariants=hoverable&&!disableMotion?{initial:"rest",whileHover:"hover",variants:cardHover,style:{willChange:"transform"}}:{};return href?(0,jsx_runtime.jsx)(proxy.P.a,{className:classes,href,ref,...motionVariants,children}):asButton?(0,jsx_runtime.jsx)(proxy.P.button,{className:classes,ref,type:"button",...motionVariants,children}):disableMotion?(0,jsx_runtime.jsx)("div",{className:classes,ref,...props,children}):(0,jsx_runtime.jsx)(proxy.P.div,{className:classes,ref,...motionVariants,children})};Card.displayName="Card";const CardHeader=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pb-4",className),ref,...props});CardHeader.displayName="CardHeader";const CardContent=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pt-0",className),ref,...props});CardContent.displayName="CardContent";const CardFooter=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("border-t border-black/5 p-6 pt-4 dark:border-white/10",className),ref,...props});CardFooter.displayName="CardFooter";const CardImage=({aspectRatio="16/9",className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("relative overflow-hidden",className),ref,style:{aspectRatio},...props});CardImage.displayName="CardImage";try{Card.displayName="Card",Card.__docgenInfo={description:"Card - Flexible container with optional animations",displayName:"Card",props:{variant:{defaultValue:{value:"default"},description:"Visual variant",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"elevated"'},{value:'"outlined"'},{value:'"glass"'}]}},hoverable:{defaultValue:{value:"false"},description:"Enable hover lift effect",name:"hoverable",required:!1,type:{name:"boolean"}},asButton:{defaultValue:{value:"false"},description:"Clickable card (renders as button)",name:"asButton",required:!1,type:{name:"boolean"}},href:{defaultValue:null,description:"Link href (renders as anchor)",name:"href",required:!1,type:{name:"string"}},disableMotion:{defaultValue:{value:"false"},description:"Disable motion animations",name:"disableMotion",required:!1,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#Card"]={docgenInfo:Card.__docgenInfo,name:"Card",path:"src/components/ui/card.tsx#Card"})}catch(__react_docgen_typescript_loader_error){}try{CardHeader.displayName="CardHeader",CardHeader.__docgenInfo={description:"CardHeader - Card header section",displayName:"CardHeader",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardHeader"]={docgenInfo:CardHeader.__docgenInfo,name:"CardHeader",path:"src/components/ui/card.tsx#CardHeader"})}catch(__react_docgen_typescript_loader_error){}try{CardContent.displayName="CardContent",CardContent.__docgenInfo={description:"CardContent - Card main content section",displayName:"CardContent",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardContent"]={docgenInfo:CardContent.__docgenInfo,name:"CardContent",path:"src/components/ui/card.tsx#CardContent"})}catch(__react_docgen_typescript_loader_error){}try{CardFooter.displayName="CardFooter",CardFooter.__docgenInfo={description:"CardFooter - Card footer section",displayName:"CardFooter",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardFooter"]={docgenInfo:CardFooter.__docgenInfo,name:"CardFooter",path:"src/components/ui/card.tsx#CardFooter"})}catch(__react_docgen_typescript_loader_error){}try{CardImage.displayName="CardImage",CardImage.__docgenInfo={description:"CardImage - Card image section",displayName:"CardImage",props:{aspectRatio:{defaultValue:{value:"16/9"},description:"",name:"aspectRatio",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardImage"]={docgenInfo:CardImage.__docgenInfo,name:"CardImage",path:"src/components/ui/card.tsx#CardImage"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function cn(...classes){return classes.filter(Boolean).join(" ")}__webpack_require__.d(__webpack_exports__,{cn:()=>cn})}}]);