"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,43054],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./src/components/admin/audit-logs-dashboard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>audit_logs_dashboard_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),audit_logs_table=__webpack_require__("./src/components/admin/audit-logs-table.tsx"),console=__webpack_require__("./node_modules/console-browserify/index.js");const audit_logs_dashboard_stories={title:"Admin/Audit Logs Dashboard",component:function AuditLogsDashboard(){const[logs,setLogs]=(0,react.useState)([]),[pagination,setPagination]=(0,react.useState)({page:1,limit:50,total:0,totalPages:0}),[isLoading,setIsLoading]=(0,react.useState)(!0),[actionFilter,setActionFilter]=(0,react.useState)("all"),[search,setSearch]=(0,react.useState)(""),[showFilters,setShowFilters]=(0,react.useState)(!1),loadLogs=(0,react.useCallback)(async()=>{setIsLoading(!0);try{const params=new URLSearchParams({page:pagination.page.toString(),limit:pagination.limit.toString()});"all"!==actionFilter&&params.append("actionType",actionFilter),search&&params.append("search",search);const response=await fetch(`/api/admin/audit-logs?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch audit logs");const data=await response.json();setLogs(data.logs),setPagination(data.pagination)}catch(error){console.error("Error loading audit logs:",error)}finally{setIsLoading(!1)}},[pagination.page,pagination.limit,actionFilter,search]);(0,react.useEffect)(()=>{loadLogs()},[loadLogs]);const activeFiltersCount="all"!==actionFilter?1:0;return(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"-translate-y-1/2 absolute top-1/2 left-4 h-5 w-5 text-slate-600 dark:text-slate-400",icon:index_min.Bbl}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 py-3 pr-4 pl-12 text-slate-900 dark:text-slate-100 placeholder:text-slate-600 dark:text-slate-400 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>{return value=e.target.value,setSearch(value),void setPagination(prev=>({...prev,page:1}));var value},placeholder:"Search by admin name, target user, or notes...",type:"text",value:search})]}),(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 font-medium text-slate-900 dark:text-slate-100 text-sm transition-colors hover:bg-white dark:bg-slate-950",onClick:()=>setShowFilters(!showFilters),children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.YGH}),"Filters",activeFiltersCount>0&&(0,jsx_runtime.jsx)("span",{className:"ml-1 rounded-full bg-slate-900 dark:bg-slate-100 px-2 py-0.5 font-semibold text-white dark:text-slate-950 text-xs",children:activeFiltersCount})]}),showFilters&&(0,jsx_runtime.jsxs)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-600 dark:text-slate-400 text-xs uppercase tracking-wider",children:"Action Type"}),(0,jsx_runtime.jsxs)("select",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2.5 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]",onChange:e=>{setActionFilter(e.target.value),setPagination(prev=>({...prev,page:1}))},value:actionFilter,children:[(0,jsx_runtime.jsx)("option",{value:"all",children:"All Actions"}),(0,jsx_runtime.jsx)("option",{value:"approve_professional",children:"Approve Professional"}),(0,jsx_runtime.jsx)("option",{value:"reject_professional",children:"Reject Professional"}),(0,jsx_runtime.jsx)("option",{value:"suspend_user",children:"Suspend User"}),(0,jsx_runtime.jsx)("option",{value:"unsuspend_user",children:"Unsuspend User"}),(0,jsx_runtime.jsx)("option",{value:"ban_user",children:"Ban User"}),(0,jsx_runtime.jsx)("option",{value:"unban_user",children:"Unban User"}),(0,jsx_runtime.jsx)("option",{value:"resolve_dispute",children:"Resolve Dispute"}),(0,jsx_runtime.jsx)("option",{value:"update_pricing",children:"Update Pricing"}),(0,jsx_runtime.jsx)("option",{value:"update_user_role",children:"Update User Role"})]})]})}),activeFiltersCount>0&&(0,jsx_runtime.jsx)("div",{className:"mt-4 border-slate-200 dark:border-slate-800 border-t pt-4",children:(0,jsx_runtime.jsx)("button",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm transition-colors hover:text-slate-900 dark:text-slate-100",onClick:()=>{setActionFilter("all"),setPagination(prev=>({...prev,page:1}))},children:"Clear all filters"})})]})]}),(0,jsx_runtime.jsx)(audit_logs_table.V,{isLoading,logs,onPageChange:page=>setPagination(prev=>({...prev,page})),pagination})]})},parameters:{layout:"centered"},tags:["autodocs"]},Default={args:{}},__namedExportsOrder=["Default"]},"./src/components/admin/audit-logs-table.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{V:()=>AuditLogsTable});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),_tanstack_react_table__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@tanstack/react-table/build/lib/index.mjs"),_tanstack_react_table__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@tanstack/table-core/build/lib/index.mjs"),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const columns=[{accessorKey:"created_at",header:"Date & Time",cell:({row})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:new Date(row.original.created_at).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})},{accessorKey:"action_type",header:"Action",cell:({row})=>{const action=row.original.action_type,config=(action=>action.includes("approve")?{bg:"bg-slate-900 dark:bg-slate-100/10",text:"text-slate-900 dark:text-slate-100",border:"border-slate-900 dark:border-slate-100/40"}:action.includes("reject")||action.includes("ban")?{bg:"bg-slate-900 dark:bg-slate-100/10",text:"text-slate-900 dark:text-slate-100",border:"border-slate-900 dark:border-slate-100/30"}:action.includes("suspend")?{bg:"bg-slate-900 dark:bg-slate-100/5",text:"text-slate-900 dark:text-slate-100",border:"border-slate-900 dark:border-slate-100/30"}:{bg:"bg-white dark:bg-slate-950",text:"text-slate-900 dark:text-slate-100",border:"border-slate-200 dark:border-slate-800"})(action);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:`inline-flex items-center rounded-lg px-2.5 py-1 font-medium text-xs ${config.bg} ${config.text} border ${config.border}`,children:action.replace(/_/g," ")})}},{accessorKey:"admin",header:"Admin",cell:({row})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:row.original.admin.full_name||"Admin"})},{accessorKey:"target_user",header:"Target User",cell:({row})=>{const target=row.original.target_user;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:target?target.full_name||"Unnamed User":"—"}),target&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-slate-600 dark:text-slate-400 text-xs",children:target.email})]})}},{accessorKey:"notes",header:"Notes",cell:({row})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"max-w-md truncate text-slate-600 dark:text-slate-400 text-sm",children:row.original.notes||"—"})}];function AuditLogsTable({logs,isLoading,pagination,onPageChange}){const[sorting,setSorting]=(0,react__WEBPACK_IMPORTED_MODULE_5__.useState)([]),table=(0,_tanstack_react_table__WEBPACK_IMPORTED_MODULE_3__.N4)({data:logs,columns,state:{sorting},onSortingChange:setSorting,getCoreRowModel:(0,_tanstack_react_table__WEBPACK_IMPORTED_MODULE_4__.HT)(),getSortedRowModel:(0,_tanstack_react_table__WEBPACK_IMPORTED_MODULE_4__.h5)()});return isLoading?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-3 text-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mx-auto h-8 w-8 animate-spin rounded-full border-4 border-slate-200 dark:border-slate-800 border-t-[#64748b]"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-slate-600 dark:text-slate-400 text-sm",children:"Loading audit logs..."})]})})}):0===logs.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-2 text-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"mx-auto h-12 w-12 text-slate-600 dark:text-slate-400",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.yNr}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-medium text-slate-900 dark:text-slate-100 text-sm",children:"No audit logs found"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-slate-600 dark:text-slate-400 text-xs",children:"Try adjusting your filters"})]})})}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overflow-hidden rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("table",{className:"w-full",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("thead",{className:"border-slate-200 dark:border-slate-800 border-b bg-white dark:bg-slate-950",children:table.getHeaderGroups().map(headerGroup=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tr",{children:headerGroup.headers.map(header=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-slate-900 dark:text-slate-100 text-xs uppercase tracking-wider",children:header.isPlaceholder?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:header.column.getCanSort()?"flex cursor-pointer select-none items-center gap-2 transition-colors hover:text-slate-900 dark:text-slate-100":"",onClick:header.column.getToggleSortingHandler(),children:[(0,_tanstack_react_table__WEBPACK_IMPORTED_MODULE_3__.Kv)(header.column.columnDef.header,header.getContext()),header.column.getCanSort()&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"asc"===header.column.getIsSorted()?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-3 w-3",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.p_k}):"desc"===header.column.getIsSorted()?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-3 w-3",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.eWi}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"h-3 w-3"})})]})},header.id))},headerGroup.id))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tbody",{className:"divide-y divide-[#e2e8f0] bg-white dark:bg-slate-950",children:table.getRowModel().rows.map(row=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("tr",{className:"transition-colors hover:bg-white dark:bg-slate-950",children:row.getVisibleCells().map(cell=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("td",{className:"whitespace-nowrap px-6 py-4",children:(0,_tanstack_react_table__WEBPACK_IMPORTED_MODULE_3__.Kv)(cell.column.columnDef.cell,cell.getContext())},cell.id))},row.id))})]})})}),pagination.totalPages>1&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-6 py-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"text-slate-600 dark:text-slate-400 text-sm",children:["Showing"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:(pagination.page-1)*pagination.limit+1})," ","to"," ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:Math.min(pagination.page*pagination.limit,pagination.total)})," ","of ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-medium text-slate-900 dark:text-slate-100",children:pagination.total})," logs"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex items-center gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 font-medium text-slate-900 dark:text-slate-100 text-sm transition-colors hover:bg-white dark:bg-slate-950 disabled:cursor-not-allowed disabled:opacity-50",disabled:1===pagination.page,onClick:()=>onPageChange(pagination.page-1),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-4 w-4",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.pQE}),"Previous"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("span",{className:"px-3 font-medium text-slate-900 dark:text-slate-100 text-sm",children:["Page ",pagination.page," of ",pagination.totalPages]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("button",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-2 font-medium text-slate-900 dark:text-slate-100 text-sm transition-colors hover:bg-white dark:bg-slate-950 disabled:cursor-not-allowed disabled:opacity-50",disabled:pagination.page===pagination.totalPages,onClick:()=>onPageChange(pagination.page+1),children:["Next",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-4 w-4",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.eXO})]})]})]})]})}try{AuditLogsTable.displayName="AuditLogsTable",AuditLogsTable.__docgenInfo={description:"",displayName:"AuditLogsTable",props:{logs:{defaultValue:null,description:"",name:"logs",required:!0,type:{name:"AuditLog[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},pagination:{defaultValue:null,description:"",name:"pagination",required:!0,type:{name:"Pagination"}},onPageChange:{defaultValue:null,description:"",name:"onPageChange",required:!0,type:{name:"(page: number) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/admin/audit-logs-table.tsx#AuditLogsTable"]={docgenInfo:AuditLogsTable.__docgenInfo,name:"AuditLogsTable",path:"src/components/admin/audit-logs-table.tsx#AuditLogsTable"})}catch(__react_docgen_typescript_loader_error){}}}]);