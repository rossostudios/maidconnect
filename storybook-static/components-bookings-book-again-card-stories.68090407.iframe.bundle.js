"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,94656],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./node_modules/next/dist/client/use-merged-ref.js":(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"useMergedRef",{enumerable:!0,get:function(){return useMergedRef}});const _react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");function useMergedRef(refA,refB){const cleanupA=(0,_react.useRef)(null),cleanupB=(0,_react.useRef)(null);return(0,_react.useCallback)(current=>{if(null===current){const cleanupFnA=cleanupA.current;cleanupFnA&&(cleanupA.current=null,cleanupFnA());const cleanupFnB=cleanupB.current;cleanupFnB&&(cleanupB.current=null,cleanupFnB())}else refA&&(cleanupA.current=applyRef(refA,current)),refB&&(cleanupB.current=applyRef(refB,current))},[refA,refB])}function applyRef(refA,current){if("function"==typeof refA){const cleanup=refA(current);return"function"==typeof cleanup?cleanup:()=>refA(null)}return refA.current=current,()=>{refA.current=null}}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default)},"./src/components/bookings/book-again-card.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>book_again_card_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),feature_flags=__webpack_require__("./src/lib/feature-flags.ts"),format=__webpack_require__("./src/lib/format.ts");const BookAgainCard=(0,react.memo)(function BookAgainCardInner({booking,onBookAgain}){const[isRebooking,setIsRebooking]=(0,react.useState)(!1),[error,setError]=(0,react.useState)(null),router=(0,navigation.useRouter)(),oneTapEnabled=(0,feature_flags.G7)("one_tap_rebook");return(0,jsx_runtime.jsxs)("div",{className:"group rounded-2xl border border-[#e2e8f0] bg-[#f8fafc] p-6 shadow-[0_10px_40px_rgba(22,22,22,0.04)] transition hover:border-[#64748b] hover:shadow-[0_20px_60px_rgba(22,22,22,0.08)]",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start gap-4",children:[(0,jsx_runtime.jsx)("div",{className:"relative h-14 w-14 flex-shrink-0 overflow-hidden rounded-full border-2 border-[#e2e8f0]",children:booking.professionalPhoto?(0,jsx_runtime.jsx)(next_image.A,{alt:booking.professionalName,className:"h-full w-full object-cover",height:56,loading:"lazy",src:booking.professionalPhoto,width:56}):(0,jsx_runtime.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-[#64748b] font-semibold text-lg text-[#f8fafc]",children:booking.professionalName.split(" ").map(n=>n[0]).join("").slice(0,2)})}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{className:"font-semibold text-[#0f172a] text-lg",children:booking.professionalName}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-sm",children:booking.serviceName})]})]}),(0,jsx_runtime.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-[#64748b]/10 px-3 py-1.5 font-medium text-[#64748b] text-xs",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-3.5 w-3.5",icon:index_min.zQd}),"Completed"]})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-4 text-[#94a3b8] text-sm",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.vxL}),(0,jsx_runtime.jsx)("span",{children:(0,format.Yq)(booking.scheduledDate)})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.p19}),(0,jsx_runtime.jsxs)("span",{children:[booking.durationHours,"h session"]})]}),(0,jsx_runtime.jsx)("div",{className:"flex items-center gap-1.5",children:(0,jsx_runtime.jsx)("span",{className:"font-semibold text-[#0f172a]",children:(0,format.Kq)(booking.amount)})})]}),error&&(0,jsx_runtime.jsx)("div",{className:"mt-4 rounded-lg bg-[#64748b]/10 px-4 py-3 text-[#64748b] text-sm",children:error}),(0,jsx_runtime.jsx)("button",{className:"mt-6 flex w-full items-center justify-center gap-2 rounded-full bg-[#64748b] px-6 py-3 font-semibold text-[#f8fafc] transition hover:bg-[#64748b] disabled:cursor-not-allowed disabled:opacity-60",disabled:isRebooking,onClick:async()=>{setIsRebooking(!0),setError(null);try{if(oneTapEnabled){const response=await fetch("/api/bookings/rebook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({originalBookingId:booking.id})});if(!response.ok){const data=await response.json();throw new Error(data.error||"Failed to create rebook")}const data=await response.json();router.push(data.redirectTo)}else onBookAgain&&await onBookAgain(booking.id)}catch(err){setError(err instanceof Error?err.message:"Failed to rebook"),setIsRebooking(!1)}},type:"button",children:oneTapEnabled?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.QTh}),isRebooking?"Creating booking...":"Book Again (1-Tap)"]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.Hoz}),isRebooking?"Preparing...":"Book Again"]})}),(0,jsx_runtime.jsx)("p",{className:"mt-2 text-center text-[#94a3b8] text-xs",children:oneTapEnabled?"All details pre-filled. Just pick a new date!":"Same service, new date. We'll prefill your preferences."})]})},(prevProps,nextProps)=>prevProps.booking.id===nextProps.booking.id&&prevProps.onBookAgain===nextProps.onBookAgain);function BookAgainSection({previousBookings,onBookAgain}){return 0===previousBookings.length?null:_jsxs("div",{className:"space-y-4",children:[_jsxs("div",{className:"flex items-center justify-between",children:[_jsx("h2",{className:"font-semibold text-2xl text-[#0f172a]",children:"Book Again"}),_jsx("p",{className:"text-[#94a3b8] text-sm",children:"Your recent professionals"})]}),_jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:previousBookings.slice(0,3).map(booking=>_jsx(BookAgainCard,{booking,onBookAgain},booking.id))})]})}try{BookAgainSection.displayName="BookAgainSection",BookAgainSection.__docgenInfo={description:"",displayName:"BookAgainSection",props:{previousBookings:{defaultValue:null,description:"",name:"previousBookings",required:!0,type:{name:"PreviousBooking[]"}},onBookAgain:{defaultValue:null,description:"",name:"onBookAgain",required:!1,type:{name:"(bookingId: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/bookings/book-again-card.tsx#BookAgainSection"]={docgenInfo:BookAgainSection.__docgenInfo,name:"BookAgainSection",path:"src/components/bookings/book-again-card.tsx#BookAgainSection"})}catch(__react_docgen_typescript_loader_error){}try{BookAgainCard.displayName="BookAgainCard",BookAgainCard.__docgenInfo={description:"",displayName:"BookAgainCard",props:{booking:{defaultValue:null,description:"",name:"booking",required:!0,type:{name:"PreviousBooking"}},onBookAgain:{defaultValue:null,description:"",name:"onBookAgain",required:!1,type:{name:"(bookingId: string) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/bookings/book-again-card.tsx#BookAgainCard"]={docgenInfo:BookAgainCard.__docgenInfo,name:"BookAgainCard",path:"src/components/bookings/book-again-card.tsx#BookAgainCard"})}catch(__react_docgen_typescript_loader_error){}const book_again_card_stories={title:"Bookings/BookAgainCard",component:BookAgainCard,parameters:{layout:"padded"},tags:["autodocs"]},Default={},__namedExportsOrder=["Default"]},"./src/lib/feature-flags.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G7:()=>isFeatureEnabled});var process=__webpack_require__("./node_modules/process/browser.js");const defaultFlags={show_match_wizard:!0,enable_web_vitals:!1,enhanced_trust_badges:!1,live_price_breakdown:!1,show_on_time_metrics:!1,auto_translate_chat:!0,one_tap_rebook:!0,recurring_plans:!0,rebook_nudge_system:!0,gps_check_in_out:!0,arrival_notifications:!0,time_extension_ui:!0,show_amara_assistant:!0,admin_verification_queue:!0,payout_ledger:!1,city_landing_pages:!0,show_platform_fee:!1,enable_tipping:!0,subscription_discount_badges:!1,caregiver_profiles:!1,maintenance_reminders:!1,referral_program:!0};function isFeatureEnabled(flag,userId){const envOverride=function getEnvOverride(flag){const envKey=`NEXT_PUBLIC_FEATURE_${flag.toUpperCase()}`,envValue=process.env[envKey];if(void 0!==envValue)return"true"===envValue||"1"===envValue}(flag);return void 0!==envOverride?envOverride:!(!userId||!function isBetaTester(userId,flag){const betaTesters={show_match_wizard:[],recurring_plans:[]};return betaTesters[flag]?.includes(userId)??!1}(userId,flag))||defaultFlags[flag]}},"./src/lib/format.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function formatCurrency(amount,options={}){const{locale="es-CO",currency="COP",minimumFractionDigits=0,maximumFractionDigits="COP"===currency?0:2}=options,safeAmount=amount??0;return Number.isFinite(safeAmount)?new Intl.NumberFormat(locale,{style:"currency",currency,minimumFractionDigits,maximumFractionDigits}).format(safeAmount):new Intl.NumberFormat(locale,{style:"currency",currency,minimumFractionDigits,maximumFractionDigits}).format(0)}function formatCOP(amount){return formatCurrency(amount,{locale:"es-CO",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0})}function formatDate(date,options={}){if(!date)return"";const{locale="en-US",weekday,year="numeric",month="short",day="numeric"}=options;try{const dateObj="string"==typeof date?new Date(date):date;return!dateObj||Number.isNaN(dateObj.getTime())?"":dateObj.toLocaleDateString(locale,{weekday,year,month,day})}catch{return""}}__webpack_require__.d(__webpack_exports__,{Kq:()=>formatCOP,Yq:()=>formatDate,vv:()=>formatCurrency})}}]);