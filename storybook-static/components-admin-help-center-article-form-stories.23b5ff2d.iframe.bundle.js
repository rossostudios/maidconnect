(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[69693],{"./messages lazy recursive ^\\.\\/.*\\.json$":(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./en.json":["./messages/en.json"],"./es.json":["./messages/es.json",81775]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return Promise.all(ids.slice(1).map(__webpack_require__.e)).then(()=>__webpack_require__.t(id,19))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id="./messages lazy recursive ^\\.\\/.*\\.json$",module.exports=webpackAsyncContext},"./src/components/admin/help-center/article-actions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N6:()=>createArticle,a:()=>deleteArticle,iZ:()=>updateArticle});var next_cache__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/cache/index.js"),zod__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/zod/v4/classic/external.js"),_lib_auth__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/lib/auth/index.ts"),_lib_supabase_server_client__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/lib/supabase/server-client.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");const ArticleSchema=zod__WEBPACK_IMPORTED_MODULE_1__.object({category_id:zod__WEBPACK_IMPORTED_MODULE_1__.string().uuid(),slug:zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1).max(100).regex(/^[a-z0-9-]+$/,"Slug must contain only lowercase letters, numbers, and hyphens"),title_en:zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1).max(200),title_es:zod__WEBPACK_IMPORTED_MODULE_1__.string().min(1).max(200),excerpt_en:zod__WEBPACK_IMPORTED_MODULE_1__.string().max(500).nullable(),excerpt_es:zod__WEBPACK_IMPORTED_MODULE_1__.string().max(500).nullable(),content_en:zod__WEBPACK_IMPORTED_MODULE_1__.string().min(10),content_es:zod__WEBPACK_IMPORTED_MODULE_1__.string().min(10),is_published:zod__WEBPACK_IMPORTED_MODULE_1__.boolean()});async function createArticle(data){await(0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.JR)({allowedRoles:["admin"]});const validated=ArticleSchema.parse(data),supabase=await(0,_lib_supabase_server_client__WEBPACK_IMPORTED_MODULE_3__.d)(),{data:existing}=await supabase.from("help_articles").select("id").eq("slug",validated.slug).maybeSingle();if(existing)throw new Error("An article with this slug already exists");const{data:article,error}=await supabase.from("help_articles").insert({category_id:validated.category_id,slug:validated.slug,title_en:validated.title_en,title_es:validated.title_es,excerpt_en:validated.excerpt_en,excerpt_es:validated.excerpt_es,content_en:validated.content_en,content_es:validated.content_es,is_published:validated.is_published,view_count:0,helpful_count:0,not_helpful_count:0}).select().single();if(error)throw console.error("Failed to create article:",error),new Error(`Failed to create article: ${error.message}`);return(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/admin/help-center"),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/help"),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)(`/help/${validated.slug}`),article}async function updateArticle(articleId,data){await(0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.JR)({allowedRoles:["admin"]});const validated=ArticleSchema.parse(data),supabase=await(0,_lib_supabase_server_client__WEBPACK_IMPORTED_MODULE_3__.d)(),{data:existing}=await supabase.from("help_articles").select("id").eq("slug",validated.slug).neq("id",articleId).maybeSingle();if(existing)throw new Error("An article with this slug already exists");const{data:article,error}=await supabase.from("help_articles").update({category_id:validated.category_id,slug:validated.slug,title_en:validated.title_en,title_es:validated.title_es,excerpt_en:validated.excerpt_en,excerpt_es:validated.excerpt_es,content_en:validated.content_en,content_es:validated.content_es,is_published:validated.is_published}).eq("id",articleId).select().single();if(error)throw console.error("Failed to update article:",error),new Error(`Failed to update article: ${error.message}`);return(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/admin/help-center"),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)(`/admin/help-center/${articleId}`),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/help"),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)(`/help/${validated.slug}`),article}async function deleteArticle(articleId){await(0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.JR)({allowedRoles:["admin"]});const supabase=await(0,_lib_supabase_server_client__WEBPACK_IMPORTED_MODULE_3__.d)(),{error}=await supabase.from("help_articles").delete().eq("id",articleId);if(error)throw console.error("Failed to delete article:",error),new Error(`Failed to delete article: ${error.message}`);return(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/admin/help-center"),(0,next_cache__WEBPACK_IMPORTED_MODULE_0__.xy)("/help"),{success:!0}}},"./src/components/admin/help-center/article-form.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>article_form_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),marked_esm=__webpack_require__("./node_modules/marked/lib/marked.esm.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),sanitize=__webpack_require__("./src/lib/sanitize.ts"),toast=__webpack_require__("./src/lib/toast.ts"),article_actions=__webpack_require__("./src/components/admin/help-center/article-actions.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");function ArticleForm({categories,article}){const router=(0,navigation.useRouter)(),isEditing=!!article,[categoryId,setCategoryId]=(0,react.useState)(article?.category_id||""),[slug,setSlug]=(0,react.useState)(article?.slug||""),[titleEn,setTitleEn]=(0,react.useState)(article?.title_en||""),[titleEs,setTitleEs]=(0,react.useState)(article?.title_es||""),[excerptEn,setExcerptEn]=(0,react.useState)(article?.excerpt_en||""),[excerptEs,setExcerptEs]=(0,react.useState)(article?.excerpt_es||""),[contentEn,setContentEn]=(0,react.useState)(article?.content_en||""),[contentEs,setContentEs]=(0,react.useState)(article?.content_es||""),[isPublished,setIsPublished]=(0,react.useState)(article?.is_published??!1),[activeTab,setActiveTab]=(0,react.useState)("en"),[previewMode,setPreviewMode]=(0,react.useState)(!1),[submitting,setSubmitting]=(0,react.useState)(!1),currentContent="en"===activeTab?contentEn:contentEs,previewHtml=(0,react.useMemo)(()=>{if(!currentContent||!previewMode)return"";const html=marked_esm.xI.parse(currentContent,{async:!1});return(0,sanitize.Ro)(html)},[currentContent,previewMode]);return(0,jsx_runtime.jsxs)("form",{className:"space-y-8",onSubmit:async e=>{if(e.preventDefault(),categoryId)if(slug)if(titleEn&&titleEs)if(contentEn&&contentEs){setSubmitting(!0);try{const formData={category_id:categoryId,slug,title_en:titleEn,title_es:titleEs,excerpt_en:excerptEn||null,excerpt_es:excerptEs||null,content_en:contentEn,content_es:contentEs,is_published:isPublished};isEditing?(await(0,article_actions.iZ)(article.id,formData),toast.o.success("Article updated successfully")):(await(0,article_actions.N6)(formData),toast.o.success("Article created successfully")),router.push("/admin/help-center"),router.refresh()}catch(error){console.error("Form submission error:",error),toast.o.error(error instanceof Error?error.message:"Failed to save article")}finally{setSubmitting(!1)}}else toast.o.error("Content is required in both languages");else toast.o.error("Title is required in both languages");else toast.o.error("Slug is required");else toast.o.error("Please select a category")},children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h1",{className:"mb-2 font-bold text-3xl text-slate-900 dark:text-slate-100",children:isEditing?"Edit Article":"Create New Article"}),(0,jsx_runtime.jsx)("p",{className:"text-slate-600 dark:text-slate-400",children:isEditing?"Update the article content and settings":"Write a new help center article"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-3",children:[(0,jsx_runtime.jsx)("button",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-6 py-3 font-semibold text-slate-900 dark:text-slate-100 transition hover:border-slate-900 dark:border-slate-100",onClick:()=>router.back(),type:"button",children:"Cancel"}),(0,jsx_runtime.jsxs)("button",{className:"inline-flex items-center gap-2 rounded-lg bg-slate-900 dark:bg-slate-100 px-6 py-3 font-semibold text-white dark:text-slate-950 transition hover:bg-slate-900 dark:bg-slate-100 disabled:opacity-50",disabled:submitting,type:"submit",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5",icon:index_min.O9W}),submitting?"Saving...":isEditing?"Update Article":"Create Article"]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"grid gap-8 lg:grid-cols-3",children:[(0,jsx_runtime.jsxs)("div",{className:"space-y-6 lg:col-span-1",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"category",children:"Category"}),(0,jsx_runtime.jsxs)("select",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 text-slate-900 dark:text-slate-100 transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"category",onChange:e=>setCategoryId(e.target.value),required:!0,value:categoryId,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select a category..."}),categories.map(cat=>(0,jsx_runtime.jsx)("option",{value:cat.id,children:cat.name_en},cat.id))]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"slug",children:"Slug (URL)"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 font-mono text-slate-900 dark:text-slate-100 text-sm transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"slug",onChange:e=>setSlug(e.target.value),placeholder:"your-article-slug",required:!0,type:"text",value:slug}),(0,jsx_runtime.jsxs)("p",{className:"mt-1 text-slate-600 dark:text-slate-400 text-xs",children:["Used in URL: /help/category/",(0,jsx_runtime.jsx)("strong",{children:slug||"slug"})]})]}),(0,jsx_runtime.jsx)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-4",children:(0,jsx_runtime.jsxs)("label",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:"Published"}),(0,jsx_runtime.jsx)("div",{className:"text-slate-600 dark:text-slate-400 text-xs",children:"Make this article visible to users"})]}),(0,jsx_runtime.jsx)("input",{checked:isPublished,className:"h-5 w-5 rounded border-slate-200 dark:border-slate-800 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-[#64748b]/20",onChange:e=>setIsPublished(e.target.checked),type:"checkbox"})]})}),(0,jsx_runtime.jsxs)("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-4",children:[(0,jsx_runtime.jsx)("h3",{className:"mb-3 font-semibold text-slate-900 dark:text-slate-100 text-sm",children:"Markdown Guide"}),(0,jsx_runtime.jsxs)("div",{className:"space-y-2 font-mono text-slate-600 dark:text-slate-400 text-xs",children:[(0,jsx_runtime.jsx)("div",{children:"# Heading 1"}),(0,jsx_runtime.jsx)("div",{children:"## Heading 2"}),(0,jsx_runtime.jsx)("div",{children:"**bold text**"}),(0,jsx_runtime.jsx)("div",{children:"*italic text*"}),(0,jsx_runtime.jsx)("div",{children:"[link](url)"}),(0,jsx_runtime.jsx)("div",{children:"- List item"}),(0,jsx_runtime.jsx)("div",{children:"`code`"}),(0,jsx_runtime.jsx)("div",{children:"```code block```"})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2",children:[(0,jsx_runtime.jsx)("button",{className:"rounded-lg px-4 py-2 font-semibold text-sm transition "+("en"===activeTab?"bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-950":"border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 text-slate-600 dark:text-slate-400 hover:border-slate-900 dark:border-slate-100"),onClick:()=>setActiveTab("en"),type:"button",children:"English"}),(0,jsx_runtime.jsx)("button",{className:"rounded-lg px-4 py-2 font-semibold text-sm transition "+("es"===activeTab?"bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-950":"border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 text-slate-600 dark:text-slate-400 hover:border-slate-900 dark:border-slate-100"),onClick:()=>setActiveTab("es"),type:"button",children:"Español"})]}),(0,jsx_runtime.jsxs)("button",{className:"inline-flex items-center gap-2 rounded-lg px-4 py-2 text-sm transition "+(previewMode?"bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-950":"border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 text-slate-600 dark:text-slate-400 hover:border-slate-900 dark:border-slate-100"),onClick:()=>setPreviewMode(!previewMode),type:"button",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:previewMode?index_min.nIA:index_min.bMW}),previewMode?"Edit":"Preview"]})]}),"en"===activeTab&&(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"title_en",children:"Title (English)"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 text-slate-900 dark:text-slate-100 transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"title_en",onChange:e=>(value=>{if(setTitleEn(value),!isEditing){const autoSlug=value.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");setSlug(autoSlug)}})(e.target.value),placeholder:"How to create your first booking",required:!0,type:"text",value:titleEn})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"excerpt_en",children:["Excerpt (English)",(0,jsx_runtime.jsx)("span",{className:"ml-2 font-normal text-slate-600 dark:text-slate-400",children:"Optional"})]}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 text-slate-900 dark:text-slate-100 transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"excerpt_en",onChange:e=>setExcerptEn(e.target.value),placeholder:"A brief summary of the article...",type:"text",value:excerptEn})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"content_en",children:"Content (English)"}),previewMode?(0,jsx_runtime.jsx)("div",{className:"prose prose-lg max-w-none prose-code:rounded rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 prose-code:bg-[#e2e8f0]/30 p-6 prose-code:px-1.5 prose-code:py-0.5 prose-headings:font-semibold prose-a:text-slate-900 dark:text-slate-100 prose-code:text-slate-900 dark:text-slate-100 prose-headings:text-slate-900 dark:text-slate-100 prose-strong:text-slate-900 dark:text-slate-100 prose-a:no-underline prose-code:before:content-none prose-code:after:content-none hover:prose-a:underline",dangerouslySetInnerHTML:{__html:previewHtml}}):(0,jsx_runtime.jsx)("textarea",{className:"min-h-[400px] w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-4 font-mono text-slate-900 dark:text-slate-100 text-sm transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"content_en",onChange:e=>setContentEn(e.target.value),placeholder:"# Article Title  Start writing your article in Markdown...  ## Section Heading  Your content here...",required:!0,value:contentEn})]})]}),"es"===activeTab&&(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"title_es",children:"Título (Español)"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 text-slate-900 dark:text-slate-100 transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"title_es",onChange:e=>setTitleEs(e.target.value),placeholder:"Cómo crear tu primera reserva",required:!0,type:"text",value:titleEs})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"excerpt_es",children:["Extracto (Español)",(0,jsx_runtime.jsx)("span",{className:"ml-2 font-normal text-slate-600 dark:text-slate-400",children:"Opcional"})]}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 text-slate-900 dark:text-slate-100 transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"excerpt_es",onChange:e=>setExcerptEs(e.target.value),placeholder:"Un breve resumen del artículo...",type:"text",value:excerptEs})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-semibold text-slate-900 dark:text-slate-100 text-sm",htmlFor:"content_es",children:"Contenido (Español)"}),previewMode?(0,jsx_runtime.jsx)("div",{className:"prose prose-lg max-w-none prose-code:rounded rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 prose-code:bg-[#e2e8f0]/30 p-6 prose-code:px-1.5 prose-code:py-0.5 prose-headings:font-semibold prose-a:text-slate-900 dark:text-slate-100 prose-code:text-slate-900 dark:text-slate-100 prose-headings:text-slate-900 dark:text-slate-100 prose-strong:text-slate-900 dark:text-slate-100 prose-a:no-underline prose-code:before:content-none prose-code:after:content-none hover:prose-a:underline",dangerouslySetInnerHTML:{__html:previewHtml}}):(0,jsx_runtime.jsx)("textarea",{className:"min-h-[400px] w-full rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-4 font-mono text-slate-900 dark:text-slate-100 text-sm transition focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"content_es",onChange:e=>setContentEs(e.target.value),placeholder:"# Título del Artículo  Empieza a escribir tu artículo en Markdown...  ## Encabezado de Sección  Tu contenido aquí...",required:!0,value:contentEs})]})]})]})]})]})}try{ArticleForm.displayName="ArticleForm",ArticleForm.__docgenInfo={description:"",displayName:"ArticleForm",props:{categories:{defaultValue:null,description:"",name:"categories",required:!0,type:{name:"Category[]"}},article:{defaultValue:null,description:"",name:"article",required:!1,type:{name:"{ id: string; category_id: string; slug: string; title_en: string; title_es: string; excerpt_en: string; excerpt_es: string; content_en: string; content_es: string; is_published: boolean; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/admin/help-center/article-form.tsx#ArticleForm"]={docgenInfo:ArticleForm.__docgenInfo,name:"ArticleForm",path:"src/components/admin/help-center/article-form.tsx#ArticleForm"})}catch(__react_docgen_typescript_loader_error){}const article_form_stories={title:"Admin/HelpCenter/ArticleForm",component:ArticleForm,parameters:{layout:"centered"},tags:["autodocs"]},Default={args:{}},__namedExportsOrder=["Default"]},"./src/i18n/routing.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{DT:()=>routing,N_:()=>Link,a8:()=>usePathname,rd:()=>useRouter});var next_intl_navigation__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next-intl/dist/esm/production/navigation/react-client/createNavigation.js");const routing=(0,__webpack_require__("./node_modules/next-intl/dist/esm/production/routing/defineRouting.js").A)({locales:["en","es"],defaultLocale:"en",localeCookie:{name:"NEXT_LOCALE",maxAge:31536e3}}),{Link,redirect,usePathname,useRouter}=(0,next_intl_navigation__WEBPACK_IMPORTED_MODULE_0__.A)(routing)},"./src/lib/auth/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ei:()=>AUTH_ROUTES,bH:()=>getDashboardRouteForRole,Ht:()=>getSession,JR:()=>requireUser});const DASHBOARD_ROUTES={professional:"/dashboard/pro",customer:"/dashboard/customer",admin:"/admin"};function getDashboardRouteForRole(role,locale){const path=DASHBOARD_ROUTES[role]??"/dashboard";return locale?`/${locale}${path}`:path}const AUTH_ROUTES={signIn:"/auth/sign-in",signUp:"/auth/sign-up",signOut:"/auth/sign-out"};var headers=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/headers/index.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react_client=__webpack_require__("./node_modules/next-intl/dist/esm/production/server/react-client/index.js"),routing=__webpack_require__("./src/i18n/routing.ts");const locales=["en","es"],defaultLocale="en";(0,react_client.M6)(async({requestLocale})=>{const locale=await requestLocale,validatedLocale=locale&&locales.includes(locale)?locale:routing.DT.defaultLocale;return{locale:validatedLocale,messages:(await __webpack_require__("./messages lazy recursive ^\\.\\/.*\\.json$")(`./${validatedLocale}.json`)).default}});var server_client=__webpack_require__("./src/lib/supabase/server-client.ts");const LOCALE_PATTERN=/^\/?([a-z]{2})\//;async function getLocaleFromHeaders(){const headersList=await(0,headers.b3)(),match=(headersList.get("x-pathname")||headersList.get("referer")||"").match(LOCALE_PATTERN);return match?.[1]||defaultLocale}async function getSession(){const supabase=await(0,server_client.d)(),{data:{session}}=await supabase.auth.getSession();if(!session?.user)return{user:null};const appUser=await async function fetchProfileForUser(supabase,userId,roleFallback="customer"){const[{data:profile,error:profileError},{data:authUser,error:authError}]=await Promise.all([supabase.from("profiles").select("role, locale, onboarding_status").eq("id",userId).maybeSingle(),supabase.auth.getUser()]);if(profileError)return null;if(authError)return null;const user=authUser.user;if(!user)return null;const role=profile?.role??roleFallback,locale=profile?.locale??"en-US",onboardingStatus=profile?.onboarding_status??"application_pending";return{id:user.id,email:user.email??null,role,locale,onboardingStatus}}(supabase,session.user.id);return{user:appUser}}async function requireUser(options={}){const{allowedRoles,fallback}=options,{user}=await getSession();if(!user){const locale=await getLocaleFromHeaders(),redirectPath=fallback||function getAuthRoute(route,locale){const path=AUTH_ROUTES[route];return locale?`/${locale}${path}`:path}("signIn",locale);(0,navigation.redirect)(redirectPath)}if(allowedRoles&&!allowedRoles.includes(user.role)){const locale=await async function getUserLocale(user){return user?.locale?user.locale.split("-")[0]||defaultLocale:await getLocaleFromHeaders()}(user);(0,navigation.redirect)(getDashboardRouteForRole(user.role,locale))}return user}},"./src/lib/sanitize.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ro:()=>sanitizeRichContent});var isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/isomorphic-dompurify/browser.js"),isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__("./node_modules/console-browserify/index.js");function sanitizeRichContent(dirty){return String(isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(dirty,{ALLOWED_TAGS:["p","br","strong","em","u","s","a","ul","ol","li","h1","h2","h3","h4","h5","h6","blockquote","code","pre","hr","table","thead","tbody","tr","th","td","img","div","span","figure","figcaption","video","audio","source"],ALLOWED_ATTR:["href","title","alt","src","class","id","rel","target","width","height","controls","autoplay","loop","muted","poster"],ALLOW_DATA_ATTR:!0,FORBID_ATTR:["onerror","onload","onclick","onmouseover"],FORBID_TAGS:["script","iframe","object","embed","form","input"]}))}},"./src/lib/supabase/server-client.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>createSupabaseServerClient});var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@supabase/ssr/dist/module/index.js"),next_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/cache/index.js"),next_headers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/headers/index.js");async function createSupabaseServerClient(){(0,next_cache__WEBPACK_IMPORTED_MODULE_1__.Mo)();const supabaseUrl="https://hvnetxfsrtplextvtwfx.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2bmV0eGZzcnRwbGV4dHZ0d2Z4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1ODc0NTEsImV4cCI6MjA3NzE2MzQ1MX0.7-N06om_ntUuGP1NZ0Zcqz01s975xJfiKno34aIW__o";const cookieStore=await(0,next_headers__WEBPACK_IMPORTED_MODULE_2__.UL)();return(0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(supabaseUrl,supabaseKey,{cookies:{getAll:()=>cookieStore.getAll(),setAll(cookiesToSet){try{cookiesToSet.forEach(({name,value,options})=>cookieStore.set(name,value,options))}catch{}}}})}},"./src/lib/toast.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{l:()=>confirm,o:()=>toast});let toastContainer=null;function showToast(message,options={}){const{duration=3e3,type="info"}=options,container=function getToastContainer(){return toastContainer&&document.body.contains(toastContainer)||(toastContainer=document.createElement("div"),toastContainer.id="toast-container",toastContainer.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 9999;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    pointer-events: none;\n  ",document.body.appendChild(toastContainer)),toastContainer}(),toast=document.createElement("div");if(toast.textContent=message,toast.style.cssText=function getToastStyles(type){return"\n    padding: 12px 20px;\n    border-radius: 8px;\n    font-family: system-ui, -apple-system, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    box-shadow: 0 4px 12px rgba(22, 22, 22, 0.15);\n    pointer-events: auto;\n    min-width: 300px;\n    max-width: 500px;\n    word-wrap: break-word;\n    animation: slideIn 0.3s ease-out;\n  "+{success:"background-color: #FF4444A22; color: white;",error:"background-color: #FF4444A22; color: white;",info:"background-color: #FF4444A22; color: white;",warning:"background-color: #FF4444A22; color: white;"}[type]}(type),!document.getElementById("toast-animations")){const style=document.createElement("style");style.id="toast-animations",style.textContent="\n      @keyframes slideIn {\n        from {\n          transform: translateX(100%);\n          opacity: 0;\n        }\n        to {\n          transform: translateX(0);\n          opacity: 1;\n        }\n      }\n      @keyframes slideOut {\n        from {\n          transform: translateX(0);\n          opacity: 1;\n        }\n        to {\n          transform: translateX(100%);\n          opacity: 0;\n        }\n      }\n    ",document.head.appendChild(style)}container.appendChild(toast),setTimeout(()=>{toast.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{toast.parentNode&&toast.parentNode.removeChild(toast),0===container.children.length&&container.parentNode&&(container.parentNode.removeChild(container),toastContainer=null)},300)},duration)}const toast={success:(message,duration)=>showToast(message,{type:"success",duration}),error:(message,duration)=>showToast(message,{type:"error",duration}),info:(message,duration)=>showToast(message,{type:"info",duration}),warning:(message,duration)=>showToast(message,{type:"warning",duration})};function confirm(message,title="Confirm"){return new Promise(resolve=>{const overlay=document.createElement("div");overlay.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: rgba(22, 22, 22, 0.5);\n      z-index: 10000;\n      display: flex;\n      align-items: center;\n      justify-center;\n      animation: fadeIn 0.2s ease-out;\n    ";const modal=document.createElement("div");modal.style.cssText="\n      background-color: white;\n      border-radius: 12px;\n      padding: 24px;\n      max-width: 400px;\n      width: 90%;\n      box-shadow: 0 20px 25px -5px rgba(22, 22, 22, 0.1);\n      animation: scaleIn 0.2s ease-out;\n    ";const titleElement=document.createElement("h3");titleElement.textContent=title,titleElement.style.cssText="\n      font-size: 18px;\n      font-weight: 600;\n      color: #116611616;\n      margin-bottom: 12px;\n    ";const messageElement=document.createElement("p");messageElement.textContent=message,messageElement.style.cssText="\n      font-size: 14px;\n      color: #116611616;\n      margin-bottom: 20px;\n      line-height: 1.5;\n    ";const buttonContainer=document.createElement("div");buttonContainer.style.cssText="\n      display: flex;\n      gap: 12px;\n      justify-content: flex-end;\n    ";const cancelButton=document.createElement("button");cancelButton.textContent="Cancel",cancelButton.style.cssText="\n      padding: 8px 16px;\n      border-radius: 8px;\n      border: 2px solid #EE44EE2E3;\n      background-color: white;\n      color: #116611616;\n      font-weight: 600;\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s;\n    ",cancelButton.onmouseover=()=>{cancelButton.style.borderColor="#AA88AAAAC",cancelButton.style.color="#AA88AAAAC"},cancelButton.onmouseout=()=>{cancelButton.style.borderColor="#EE44EE2E3",cancelButton.style.color="#116611616"};const confirmButton=document.createElement("button");confirmButton.textContent="Confirm",confirmButton.style.cssText="\n      padding: 8px 16px;\n      border-radius: 8px;\n      border: none;\n      background-color: #AA88AAAAC;\n      color: white;\n      font-weight: 600;\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s;\n    ",confirmButton.onmouseover=()=>{confirmButton.style.backgroundColor="#AA88AAAAC"},confirmButton.onmouseout=()=>{confirmButton.style.backgroundColor="#AA88AAAAC"};const cleanup=()=>{overlay.style.animation="fadeOut 0.2s ease-in",setTimeout(()=>{overlay.parentNode&&overlay.parentNode.removeChild(overlay)},200)};if(cancelButton.onclick=()=>{cleanup(),resolve(!1)},confirmButton.onclick=()=>{cleanup(),resolve(!0)},!document.getElementById("modal-animations")){const style=document.createElement("style");style.id="modal-animations",style.textContent="\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes fadeOut {\n          from { opacity: 1; }\n          to { opacity: 0; }\n        }\n        @keyframes scaleIn {\n          from {\n            transform: scale(0.9);\n            opacity: 0;\n          }\n          to {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n      ",document.head.appendChild(style)}buttonContainer.appendChild(cancelButton),buttonContainer.appendChild(confirmButton),modal.appendChild(titleElement),modal.appendChild(messageElement),modal.appendChild(buttonContainer),overlay.appendChild(modal),document.body.appendChild(overlay),confirmButton.focus()})}}}]);