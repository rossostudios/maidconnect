"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,49970],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./node_modules/next/dist/client/use-merged-ref.js":(module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"useMergedRef",{enumerable:!0,get:function(){return useMergedRef}});const _react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");function useMergedRef(refA,refB){const cleanupA=(0,_react.useRef)(null),cleanupB=(0,_react.useRef)(null);return(0,_react.useCallback)(current=>{if(null===current){const cleanupFnA=cleanupA.current;cleanupFnA&&(cleanupA.current=null,cleanupFnA());const cleanupFnB=cleanupB.current;cleanupFnB&&(cleanupB.current=null,cleanupFnB())}else refA&&(cleanupA.current=applyRef(refA,current)),refB&&(cleanupB.current=applyRef(refB,current))},[refA,refB])}function applyRef(refA,current){if("function"==typeof refA){const cleanup=refA(current);return"function"==typeof cleanup?cleanup:()=>refA(null)}return refA.current=current,()=>{refA.current=null}}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default)},"./src/components/professional/lead-queue.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>lead_queue_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),formatDistanceToNow=__webpack_require__("./node_modules/date-fns/formatDistanceToNow.js"),next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),format=__webpack_require__("./src/lib/format.ts"),toast=__webpack_require__("./src/lib/toast.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");function LeadQueue({initialBookings,professionalId:_professionalId}){const[bookings,setBookings]=(0,react.useState)(initialBookings),[filter,setFilter]=(0,react.useState)("all"),filteredBookings=bookings.filter(booking=>"all"===filter||("pending"===filter?"pending"===booking.status||"pending_payment"===booking.status:"confirmed"!==filter||"confirmed"===booking.status)),pendingCount=bookings.filter(b=>"pending"===b.status||"pending_payment"===b.status).length,confirmedCount=bookings.filter(b=>"confirmed"===b.status).length,handleAccept=async bookingId=>{try{if(!(await fetch(`/api/bookings/${bookingId}/accept`,{method:"POST"})).ok)throw new Error("Failed to accept booking");setBookings(bookings.map(b=>b.id===bookingId?{...b,status:"confirmed"}:b)),toast.o.success("Booking accepted! The customer has been notified.")}catch(error){console.error("Failed to accept booking:",error),toast.o.error("Failed to accept booking. Please try again.")}},handleDecline=async bookingId=>{try{if(!(await fetch(`/api/bookings/${bookingId}/decline`,{method:"POST"})).ok)throw new Error("Failed to decline booking");setBookings(bookings.filter(b=>b.id!==bookingId)),toast.o.success("Booking declined")}catch(error){console.error("Failed to decline booking:",error),toast.o.error("Failed to decline booking. Please try again.")}};return(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{className:"flex gap-2 border-[#e2e8f0] border-b",children:[(0,jsx_runtime.jsxs)("button",{className:"border-b-2 px-6 py-3 font-medium text-sm transition "+("all"===filter?"border-[#64748b] text-[#64748b]":"border-transparent text-[#94a3b8] hover:text-[#0f172a]"),onClick:()=>setFilter("all"),children:["All (",bookings.length,")"]}),(0,jsx_runtime.jsxs)("button",{className:"border-b-2 px-6 py-3 font-medium text-sm transition "+("pending"===filter?"border-[#64748b] text-[#64748b]":"border-transparent text-[#94a3b8] hover:text-[#0f172a]"),onClick:()=>setFilter("pending"),children:["Pending (",pendingCount,")"]}),(0,jsx_runtime.jsxs)("button",{className:"border-b-2 px-6 py-3 font-medium text-sm transition "+("confirmed"===filter?"border-[#64748b] text-[#64748b]":"border-transparent text-[#94a3b8] hover:text-[#0f172a]"),onClick:()=>setFilter("confirmed"),children:["Confirmed (",confirmedCount,")"]})]}),0===filteredBookings.length?(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-[#e2e8f0] bg-[#f8fafc] p-12 text-center",children:[(0,jsx_runtime.jsx)("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-[#e2e8f0]",children:(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-8 w-8 text-[#94a3b8]",icon:index_min.TSf})}),(0,jsx_runtime.jsx)("h3",{className:"font-semibold text-[#0f172a] text-xl",children:"pending"===filter?"No pending requests":"confirmed"===filter?"No confirmed bookings":"No booking requests"}),(0,jsx_runtime.jsx)("p",{className:"mt-2 text-[#94a3b8]",children:"pending"===filter?"You're all caught up! New requests will appear here.":"confirmed"===filter?"Confirmed bookings will show here.":"Booking requests will appear here when customers request your services."})]}):(0,jsx_runtime.jsx)("div",{className:"grid grid-cols-1 gap-6",children:filteredBookings.map(booking=>(0,jsx_runtime.jsx)(LeadCard,{booking,onAccept:handleAccept,onDecline:handleDecline},booking.id))})]})}function LeadCard({booking,onAccept,onDecline}){const[isProcessing,setIsProcessing]=(0,react.useState)(!1),isPending="pending"===booking.status||"pending_payment"===booking.status;return(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-[#e2e8f0] bg-[#f8fafc] p-6 shadow-sm transition hover:shadow-md",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-start gap-6",children:[(0,jsx_runtime.jsx)("div",{className:"flex-shrink-0",children:booking.customer?.avatar_url?(0,jsx_runtime.jsx)(next_image.A,{alt:booking.customer.full_name,className:"h-16 w-16 rounded-full object-cover",height:64,src:booking.customer.avatar_url,width:64}):(0,jsx_runtime.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-[#64748b] font-bold text-[#f8fafc] text-xl",children:booking.customer?.full_name?.charAt(0).toUpperCase()||"?"})}),(0,jsx_runtime.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,jsx_runtime.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("h3",{className:"mb-1 font-bold text-[#0f172a] text-xl",children:booking.service_name}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-[#94a3b8] text-sm",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.nys}),(0,jsx_runtime.jsx)("span",{children:booking.customer?.full_name||"Unknown Customer"})]})]}),(0,jsx_runtime.jsx)("span",{className:"inline-flex rounded-full px-3 py-1 font-semibold text-xs "+(isPending||"confirmed"===booking.status?"bg-[#64748b]/10 text-[#64748b]":"bg-[#e2e8f0]/30 text-[#94a3b8]"),children:isPending?"Pending Response":"confirmed"===booking.status?"Confirmed":booking.status})]}),(0,jsx_runtime.jsxs)("div",{className:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5 text-[#64748b]",icon:index_min.TSf}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{className:"font-medium text-[#0f172a]",children:new Date(booking.scheduled_start).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-xs",children:new Date(booking.scheduled_start).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})]}),booking.duration_minutes&&(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5 text-[#64748b]",icon:index_min.p19}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsxs)("p",{className:"font-medium text-[#0f172a]",children:[booking.duration_minutes," minutes"]}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-xs",children:"Duration"})]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,jsx_runtime.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-[#64748b]/10 font-bold text-[#64748b] text-xs",children:"$"}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{className:"font-medium text-[#0f172a]",children:(0,format.vv)(booking.amount_estimated,{currency:"COP"===booking.currency||"USD"===booking.currency?booking.currency:"COP"})}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-xs",children:"Estimated"})]})]})]}),booking.address&&(0,jsx_runtime.jsxs)("div",{className:"mb-4 flex items-start gap-2 text-sm",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"mt-0.5 h-5 w-5 flex-shrink-0 text-[#94a3b8]",icon:index_min.BT6}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8]",children:booking.address})]}),booking.special_instructions&&(0,jsx_runtime.jsxs)("div",{className:"mb-4 rounded-lg bg-[#f8fafc] p-4",children:[(0,jsx_runtime.jsx)("p",{className:"mb-1 font-medium text-[#0f172a] text-sm",children:"Special Instructions:"}),(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-sm",children:booking.special_instructions})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between text-[#94a3b8] text-xs",children:[(0,jsx_runtime.jsxs)("span",{children:["Requested ",(0,formatDistanceToNow.m)(new Date(booking.created_at),{addSuffix:!0})]}),(0,jsx_runtime.jsxs)("span",{children:["ID: ",booking.id.slice(0,8)]})]})]})]}),isPending&&(0,jsx_runtime.jsxs)("div",{className:"mt-6 flex gap-3 border-[#e2e8f0] border-t pt-6",children:[(0,jsx_runtime.jsx)("button",{className:"flex-1 rounded-lg border-2 border-[#e2e8f0] bg-[#f8fafc] px-6 py-3 font-semibold text-[#0f172a] transition hover:border-[#64748b]/100 hover:text-[#64748b] disabled:cursor-not-allowed disabled:opacity-50",disabled:isProcessing,onClick:async()=>{confirm("Are you sure you want to decline this booking request?")&&(setIsProcessing(!0),await onDecline(booking.id),setIsProcessing(!1))},children:isProcessing?"Processing...":"Decline"}),(0,jsx_runtime.jsx)("button",{className:"flex-1 rounded-lg bg-[#64748b] px-6 py-3 font-semibold text-[#f8fafc] transition hover:bg-[#64748b] disabled:cursor-not-allowed disabled:opacity-50",disabled:isProcessing,onClick:async()=>{setIsProcessing(!0),await onAccept(booking.id),setIsProcessing(!1)},children:isProcessing?"Processing...":"Accept Booking"})]}),"confirmed"===booking.status&&(0,jsx_runtime.jsx)("div",{className:"mt-6 border-[#e2e8f0] border-t pt-6",children:(0,jsx_runtime.jsx)("button",{className:"w-full rounded-lg border border-[#e2e8f0] px-6 py-3 font-semibold text-[#0f172a] transition hover:border-[#64748b] hover:text-[#64748b]",children:"View Booking Details"})})]})}try{LeadQueue.displayName="LeadQueue",LeadQueue.__docgenInfo={description:"",displayName:"LeadQueue",props:{initialBookings:{defaultValue:null,description:"",name:"initialBookings",required:!0,type:{name:"BookingLead[]"}},professionalId:{defaultValue:null,description:"",name:"professionalId",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/professional/lead-queue.tsx#LeadQueue"]={docgenInfo:LeadQueue.__docgenInfo,name:"LeadQueue",path:"src/components/professional/lead-queue.tsx#LeadQueue"})}catch(__react_docgen_typescript_loader_error){}const lead_queue_stories={title:"Professional/LeadQueue",component:LeadQueue,parameters:{layout:"padded"},tags:["autodocs"]},Default={},__namedExportsOrder=["Default"]},"./src/lib/format.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function formatCurrency(amount,options={}){const{locale="es-CO",currency="COP",minimumFractionDigits=0,maximumFractionDigits="COP"===currency?0:2}=options,safeAmount=amount??0;return Number.isFinite(safeAmount)?new Intl.NumberFormat(locale,{style:"currency",currency,minimumFractionDigits,maximumFractionDigits}).format(safeAmount):new Intl.NumberFormat(locale,{style:"currency",currency,minimumFractionDigits,maximumFractionDigits}).format(0)}function formatCOP(amount){return formatCurrency(amount,{locale:"es-CO",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0})}function formatDate(date,options={}){if(!date)return"";const{locale="en-US",weekday,year="numeric",month="short",day="numeric"}=options;try{const dateObj="string"==typeof date?new Date(date):date;return!dateObj||Number.isNaN(dateObj.getTime())?"":dateObj.toLocaleDateString(locale,{weekday,year,month,day})}catch{return""}}__webpack_require__.d(__webpack_exports__,{Kq:()=>formatCOP,Yq:()=>formatDate,vv:()=>formatCurrency})},"./src/lib/toast.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>confirm,o:()=>toast});let toastContainer=null;function showToast(message,options={}){const{duration=3e3,type="info"}=options,container=function getToastContainer(){return toastContainer&&document.body.contains(toastContainer)||(toastContainer=document.createElement("div"),toastContainer.id="toast-container",toastContainer.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    z-index: 9999;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    pointer-events: none;\n  ",document.body.appendChild(toastContainer)),toastContainer}(),toast=document.createElement("div");if(toast.textContent=message,toast.style.cssText=function getToastStyles(type){return"\n    padding: 12px 20px;\n    border-radius: 8px;\n    font-family: system-ui, -apple-system, sans-serif;\n    font-size: 14px;\n    font-weight: 500;\n    box-shadow: 0 4px 12px rgba(22, 22, 22, 0.15);\n    pointer-events: auto;\n    min-width: 300px;\n    max-width: 500px;\n    word-wrap: break-word;\n    animation: slideIn 0.3s ease-out;\n  "+{success:"background-color: #FF4444A22; color: white;",error:"background-color: #FF4444A22; color: white;",info:"background-color: #FF4444A22; color: white;",warning:"background-color: #FF4444A22; color: white;"}[type]}(type),!document.getElementById("toast-animations")){const style=document.createElement("style");style.id="toast-animations",style.textContent="\n      @keyframes slideIn {\n        from {\n          transform: translateX(100%);\n          opacity: 0;\n        }\n        to {\n          transform: translateX(0);\n          opacity: 1;\n        }\n      }\n      @keyframes slideOut {\n        from {\n          transform: translateX(0);\n          opacity: 1;\n        }\n        to {\n          transform: translateX(100%);\n          opacity: 0;\n        }\n      }\n    ",document.head.appendChild(style)}container.appendChild(toast),setTimeout(()=>{toast.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{toast.parentNode&&toast.parentNode.removeChild(toast),0===container.children.length&&container.parentNode&&(container.parentNode.removeChild(container),toastContainer=null)},300)},duration)}const toast={success:(message,duration)=>showToast(message,{type:"success",duration}),error:(message,duration)=>showToast(message,{type:"error",duration}),info:(message,duration)=>showToast(message,{type:"info",duration}),warning:(message,duration)=>showToast(message,{type:"warning",duration})};function confirm(message,title="Confirm"){return new Promise(resolve=>{const overlay=document.createElement("div");overlay.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: rgba(22, 22, 22, 0.5);\n      z-index: 10000;\n      display: flex;\n      align-items: center;\n      justify-center;\n      animation: fadeIn 0.2s ease-out;\n    ";const modal=document.createElement("div");modal.style.cssText="\n      background-color: white;\n      border-radius: 12px;\n      padding: 24px;\n      max-width: 400px;\n      width: 90%;\n      box-shadow: 0 20px 25px -5px rgba(22, 22, 22, 0.1);\n      animation: scaleIn 0.2s ease-out;\n    ";const titleElement=document.createElement("h3");titleElement.textContent=title,titleElement.style.cssText="\n      font-size: 18px;\n      font-weight: 600;\n      color: #116611616;\n      margin-bottom: 12px;\n    ";const messageElement=document.createElement("p");messageElement.textContent=message,messageElement.style.cssText="\n      font-size: 14px;\n      color: #116611616;\n      margin-bottom: 20px;\n      line-height: 1.5;\n    ";const buttonContainer=document.createElement("div");buttonContainer.style.cssText="\n      display: flex;\n      gap: 12px;\n      justify-content: flex-end;\n    ";const cancelButton=document.createElement("button");cancelButton.textContent="Cancel",cancelButton.style.cssText="\n      padding: 8px 16px;\n      border-radius: 8px;\n      border: 2px solid #EE44EE2E3;\n      background-color: white;\n      color: #116611616;\n      font-weight: 600;\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s;\n    ",cancelButton.onmouseover=()=>{cancelButton.style.borderColor="#AA88AAAAC",cancelButton.style.color="#AA88AAAAC"},cancelButton.onmouseout=()=>{cancelButton.style.borderColor="#EE44EE2E3",cancelButton.style.color="#116611616"};const confirmButton=document.createElement("button");confirmButton.textContent="Confirm",confirmButton.style.cssText="\n      padding: 8px 16px;\n      border-radius: 8px;\n      border: none;\n      background-color: #AA88AAAAC;\n      color: white;\n      font-weight: 600;\n      font-size: 14px;\n      cursor: pointer;\n      transition: all 0.2s;\n    ",confirmButton.onmouseover=()=>{confirmButton.style.backgroundColor="#AA88AAAAC"},confirmButton.onmouseout=()=>{confirmButton.style.backgroundColor="#AA88AAAAC"};const cleanup=()=>{overlay.style.animation="fadeOut 0.2s ease-in",setTimeout(()=>{overlay.parentNode&&overlay.parentNode.removeChild(overlay)},200)};if(cancelButton.onclick=()=>{cleanup(),resolve(!1)},confirmButton.onclick=()=>{cleanup(),resolve(!0)},!document.getElementById("modal-animations")){const style=document.createElement("style");style.id="modal-animations",style.textContent="\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        @keyframes fadeOut {\n          from { opacity: 1; }\n          to { opacity: 0; }\n        }\n        @keyframes scaleIn {\n          from {\n            transform: scale(0.9);\n            opacity: 0;\n          }\n          to {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n      ",document.head.appendChild(style)}buttonContainer.appendChild(cancelButton),buttonContainer.appendChild(confirmButton),modal.appendChild(titleElement),modal.appendChild(messageElement),modal.appendChild(buttonContainer),overlay.appendChild(modal),document.body.appendChild(overlay),confirmButton.focus()})}}}]);