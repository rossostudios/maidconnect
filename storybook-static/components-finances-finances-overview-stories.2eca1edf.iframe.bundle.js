"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[86581],{"./src/components/finances/finances-overview.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,Empty:()=>Empty,ManyBookings:()=>ManyBookings,__namedExportsOrder:()=>__namedExportsOrder,default:()=>finances_overview_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),isSameMonth=__webpack_require__("./node_modules/date-fns/isSameMonth.js"),parseISO=__webpack_require__("./node_modules/date-fns/parseISO.js"),eachMonthOfInterval=__webpack_require__("./node_modules/date-fns/eachMonthOfInterval.js"),subMonths=__webpack_require__("./node_modules/date-fns/subMonths.js"),format=__webpack_require__("./node_modules/date-fns/format.js"),dynamic=__webpack_require__("./node_modules/next/dynamic.js"),dynamic_default=__webpack_require__.n(dynamic),react_client=__webpack_require__("./node_modules/next-intl/dist/esm/production/react-client/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),card=__webpack_require__("./src/components/ui/card.tsx");const COLORS=["#475569","#0f172a","#64748b","#94a3b8","#cbd5e1"],LineChartComponent=dynamic_default()(()=>Promise.all([__webpack_require__.e(81083),__webpack_require__.e(61023),__webpack_require__.e(67071),__webpack_require__.e(61532),__webpack_require__.e(15236)]).then(__webpack_require__.bind(__webpack_require__,"__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js")).then(mod=>({default:({data,formatCurrency})=>{const{LineChart,Line,CartesianGrid,XAxis,YAxis,Tooltip,ResponsiveContainer}=mod;return(0,jsx_runtime.jsx)(ResponsiveContainer,{height:300,width:"100%",children:(0,jsx_runtime.jsxs)(LineChart,{data,children:[(0,jsx_runtime.jsx)(CartesianGrid,{stroke:"#e2e8f0",strokeDasharray:"3 3"}),(0,jsx_runtime.jsx)(XAxis,{dataKey:"month",stroke:"#64748b",style:{fontSize:12}}),(0,jsx_runtime.jsx)(YAxis,{stroke:"#64748b",style:{fontSize:12},tickFormatter:value=>`${value}k`}),(0,jsx_runtime.jsx)(Tooltip,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px"},formatter:value=>formatCurrency(value)}),(0,jsx_runtime.jsx)(Line,{activeDot:{r:6},dataKey:"earnings",dot:{fill:"#0f172a",r:4},stroke:"#0f172a",strokeWidth:3,type:"monotone"})]})})}})),{loadableGenerated:{webpack:()=>["__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js"]},ssr:!1,loading:()=>(0,jsx_runtime.jsx)(ChartSkeleton,{})}),BarChartComponent=dynamic_default()(()=>Promise.all([__webpack_require__.e(81083),__webpack_require__.e(61023),__webpack_require__.e(67071),__webpack_require__.e(61532),__webpack_require__.e(15236)]).then(__webpack_require__.bind(__webpack_require__,"__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js")).then(mod=>({default:({data,dataKey="bookings",fill="#64748b",formatter})=>{const{BarChart,Bar,CartesianGrid,XAxis,YAxis,Tooltip,ResponsiveContainer}=mod;return(0,jsx_runtime.jsx)(ResponsiveContainer,{height:300,width:"100%",children:(0,jsx_runtime.jsxs)(BarChart,{data,children:[(0,jsx_runtime.jsx)(CartesianGrid,{stroke:"#e2e8f0",strokeDasharray:"3 3"}),(0,jsx_runtime.jsx)(XAxis,{dataKey:"bookings"===dataKey?"month":"date",stroke:"#94a3b8",style:{fontSize:12}}),(0,jsx_runtime.jsx)(YAxis,{stroke:"#94a3b8",style:{fontSize:12},tickFormatter:formatter?value=>`${value}k`:void 0}),(0,jsx_runtime.jsx)(Tooltip,{contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px"},formatter}),(0,jsx_runtime.jsx)(Bar,{dataKey,fill,radius:[8,8,0,0]})]})})}})),{loadableGenerated:{webpack:()=>["__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js"]},ssr:!1,loading:()=>(0,jsx_runtime.jsx)(ChartSkeleton,{})}),PieChartComponent=dynamic_default()(()=>Promise.all([__webpack_require__.e(81083),__webpack_require__.e(61023),__webpack_require__.e(67071),__webpack_require__.e(61532),__webpack_require__.e(15236)]).then(__webpack_require__.bind(__webpack_require__,"__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js")).then(mod=>({default:({data,formatCurrency})=>{const{PieChart,Pie,Cell,Tooltip,ResponsiveContainer}=mod;return(0,jsx_runtime.jsx)(ResponsiveContainer,{height:300,width:"100%",children:(0,jsx_runtime.jsxs)(PieChart,{children:[(0,jsx_runtime.jsx)(Pie,{cx:"50%",cy:"50%",data,dataKey:"value",fill:"#64748b",label:props=>`${props.name} (${(100*props.percent).toFixed(0)}%)`,labelLine:!1,outerRadius:100,children:data.map((_entry,index)=>(0,jsx_runtime.jsx)(Cell,{fill:COLORS[index%COLORS.length]},`cell-${index}`))}),(0,jsx_runtime.jsx)(Tooltip,{formatter:value=>formatCurrency(value)})]})})}})),{loadableGenerated:{webpack:()=>["__barrel_optimize__?names=Bar,BarChart,CartesianGrid,Cell,Line,LineChart,Pie,PieChart,ResponsiveContainer,XAxis,YAxis!=!./node_modules/recharts/es6/index.js"]},ssr:!1,loading:()=>(0,jsx_runtime.jsx)(ChartSkeleton,{})});function ChartSkeleton(){return(0,jsx_runtime.jsx)("div",{className:"h-[300px] w-full animate-pulse rounded-lg bg-gradient-to-br from-slate-100 to-slate-50"})}function FinancesOverview({bookings,payouts}){const t=(0,react_client.c3)("dashboard.pro.financesOverview"),metrics=(0,react.useMemo)(()=>{const totalEarnings=bookings.reduce((sum,b)=>sum+(b.amount_captured||0),0),avgBookingValue=bookings.length>0?totalEarnings/bookings.length:0,monthlyEarnings=bookings.filter(b=>b.scheduled_start&&(0,isSameMonth.t)((0,parseISO.H)(b.scheduled_start),new Date)).reduce((sum,b)=>sum+(b.amount_captured||0),0),pendingPayouts=payouts.filter(p=>"pending"===p.status).reduce((sum,p)=>sum+p.amount,0);return{totalEarnings,avgBookingValue,monthlyEarnings,totalBookings:bookings.length,pendingPayouts}},[bookings,payouts]),earningsData=(0,react.useMemo)(()=>(0,eachMonthOfInterval.i)({start:(0,subMonths.a)(new Date,5),end:new Date}).map(month=>{const monthBookings=bookings.filter(b=>b.scheduled_start&&(0,isSameMonth.t)((0,parseISO.H)(b.scheduled_start),month)),earnings=monthBookings.reduce((sum,b)=>sum+(b.amount_captured||0),0);return{month:(0,format.GP)(month,"MMM yyyy"),earnings:earnings/1e3,bookings:monthBookings.length}}),[bookings]),serviceData=(0,react.useMemo)(()=>{const serviceMap=new Map;for(const b of bookings){const service=b.service_name||"Other";serviceMap.set(service,(serviceMap.get(service)||0)+(b.amount_captured||0))}return Array.from(serviceMap.entries()).map(([name,value])=>({name,value:value/1e3})).sort((a,b)=>b.value-a.value).slice(0,5)},[bookings]),payoutHistory=(0,react.useMemo)(()=>payouts.filter(p=>"completed"===p.status).slice(0,10).map(p=>({date:(0,format.GP)((0,parseISO.H)(p.processed_at||p.created_at),"MMM dd"),amount:p.amount/1e3})),[payouts]),formatCurrency=value=>new Intl.NumberFormat("en-US",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(1e3*value);return(0,jsx_runtime.jsxs)("div",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[(0,jsx_runtime.jsx)(MetricCard,{description:t("metrics.totalEarnings.description"),label:t("metrics.totalEarnings.label"),value:formatCurrency(metrics.totalEarnings/1e3)}),(0,jsx_runtime.jsx)(MetricCard,{description:`${bookings.filter(b=>b.scheduled_start&&(0,isSameMonth.t)((0,parseISO.H)(b.scheduled_start),new Date)).length} ${t("metrics.thisMonth.label").toLowerCase()}`,label:t("metrics.thisMonth.label"),value:formatCurrency(metrics.monthlyEarnings/1e3)}),(0,jsx_runtime.jsx)(MetricCard,{description:`${metrics.totalBookings} ${t("metrics.avgBookingValue.description")}`,label:t("metrics.avgBookingValue.label"),value:formatCurrency(metrics.avgBookingValue/1e3)}),(0,jsx_runtime.jsx)(MetricCard,{description:`${payouts.filter(p=>"pending"===p.status).length} ${t("metrics.pendingPayouts.descriptionSuffix")}`,label:t("metrics.pendingPayouts.label"),value:formatCurrency(metrics.pendingPayouts/1e3)})]}),(0,jsx_runtime.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,jsx_runtime.jsxs)(card.Zp,{className:"border-slate-200 bg-white shadow-sm",children:[(0,jsx_runtime.jsx)(card.aR,{className:"p-8 pb-6",children:(0,jsx_runtime.jsx)("h2",{className:"font-semibold text-slate-900 text-xl",children:t("charts.earningsTrend")})}),(0,jsx_runtime.jsx)(card.Wu,{className:"p-8 pt-0",children:(0,jsx_runtime.jsx)(LineChartComponent,{data:earningsData,formatCurrency})})]}),(0,jsx_runtime.jsxs)(card.Zp,{className:"border-slate-200 bg-white shadow-sm",children:[(0,jsx_runtime.jsx)(card.aR,{className:"p-8 pb-6",children:(0,jsx_runtime.jsx)("h2",{className:"font-semibold text-slate-900 text-xl",children:t("charts.bookingsByMonth")})}),(0,jsx_runtime.jsx)(card.Wu,{className:"p-8 pt-0",children:(0,jsx_runtime.jsx)(BarChartComponent,{data:earningsData,dataKey:"bookings",fill:"#475569"})})]}),serviceData.length>0&&(0,jsx_runtime.jsxs)(card.Zp,{className:"border-slate-200 bg-white shadow-sm",children:[(0,jsx_runtime.jsx)(card.aR,{className:"p-8 pb-6",children:(0,jsx_runtime.jsx)("h2",{className:"font-semibold text-slate-900 text-xl",children:t("charts.revenueByService")})}),(0,jsx_runtime.jsx)(card.Wu,{className:"p-8 pt-0",children:(0,jsx_runtime.jsx)(PieChartComponent,{data:serviceData,formatCurrency})})]}),payoutHistory.length>0&&(0,jsx_runtime.jsxs)(card.Zp,{className:"border-slate-200 bg-white shadow-sm",children:[(0,jsx_runtime.jsx)(card.aR,{className:"p-8 pb-6",children:(0,jsx_runtime.jsx)("h2",{className:"font-semibold text-slate-900 text-xl",children:t("charts.recentPayouts")})}),(0,jsx_runtime.jsx)(card.Wu,{className:"p-8 pt-0",children:(0,jsx_runtime.jsx)(BarChartComponent,{data:payoutHistory,dataKey:"amount",fill:"#0f172a",formatter:formatCurrency})})]})]})]})}function MetricCard({label,value,description}){return(0,jsx_runtime.jsx)(card.Zp,{className:"border-slate-200 bg-white shadow-sm",children:(0,jsx_runtime.jsxs)(card.Wu,{className:"p-6",children:[(0,jsx_runtime.jsx)("dt",{className:"font-semibold text-slate-600 text-xs uppercase tracking-wider",children:label}),(0,jsx_runtime.jsx)("dd",{className:"mt-3 font-semibold text-3xl text-slate-900",children:value}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-slate-600 text-sm",children:description})]})})}try{FinancesOverview.displayName="FinancesOverview",FinancesOverview.__docgenInfo={description:"",displayName:"FinancesOverview",props:{bookings:{defaultValue:null,description:"",name:"bookings",required:!0,type:{name:"Booking[]"}},payouts:{defaultValue:null,description:"",name:"payouts",required:!0,type:{name:"Payout[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/finances/finances-overview.tsx#FinancesOverview"]={docgenInfo:FinancesOverview.__docgenInfo,name:"FinancesOverview",path:"src/components/finances/finances-overview.tsx#FinancesOverview"})}catch(__react_docgen_typescript_loader_error){}const finances_overview_stories={title:"Finances/FinancesOverview",component:FinancesOverview,parameters:{layout:"padded",docs:{description:{component:"Comprehensive financial dashboard showing earnings trends, bookings analytics, and revenue breakdown for professionals."}}},tags:["autodocs"]},sampleBookings=[{id:"1",status:"completed",scheduled_start:"2025-01-15T10:00:00Z",amount_captured:15e4,amount_authorized:15e4,currency:"COP",service_name:"House Cleaning",created_at:"2025-01-10T09:00:00Z"},{id:"2",status:"completed",scheduled_start:"2024-12-20T14:00:00Z",amount_captured:2e5,amount_authorized:2e5,currency:"COP",service_name:"Deep Cleaning",created_at:"2024-12-18T11:30:00Z"},{id:"3",status:"completed",scheduled_start:"2024-11-25T09:00:00Z",amount_captured:12e4,amount_authorized:12e4,currency:"COP",service_name:"Regular Cleaning",created_at:"2024-11-22T16:45:00Z"}],samplePayouts=[{id:"1",amount:15e4,status:"pending",created_at:"2025-01-15T10:00:00Z",processed_at:null},{id:"2",amount:2e5,status:"completed",created_at:"2024-12-20T10:00:00Z",processed_at:"2024-12-22T10:00:00Z"}],Default={args:{bookings:sampleBookings,payouts:samplePayouts}},Empty={args:{bookings:[],payouts:[]}},ManyBookings={args:{bookings:[...sampleBookings,...sampleBookings,...sampleBookings],payouts:samplePayouts}},__namedExportsOrder=["Default","Empty","ManyBookings"]},"./src/components/ui/card.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Zp:()=>Card,Wu:()=>CardContent,wL:()=>CardFooter,aR:()=>CardHeader,MH:()=>CardImage});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),proxy=__webpack_require__("./node_modules/framer-motion/dist/es/render/components/motion/proxy.mjs"),dist=__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs");const cardHover={rest:{scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25}},hover:{scale:1.01,y:-2,transition:{type:"spring",stiffness:400,damping:25}}};var utils=__webpack_require__("./src/lib/utils.ts");const cardVariants=(0,dist.F)("rounded-lg overflow-hidden transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-900",{variants:{variant:{default:"bg-white ring-1 ring-black/5 shadow-sm dark:bg-neutral-900 dark:ring-white/10",elevated:"bg-white ring-1 ring-black/5 shadow-md dark:bg-neutral-900 dark:ring-white/10",outlined:"bg-white ring-1 ring-black/8 shadow-none dark:bg-neutral-900 dark:ring-white/12",glass:"bg-white/70 ring-1 ring-black/5 shadow-sm backdrop-blur-lg dark:bg-neutral-900/70 dark:ring-white/10"}},defaultVariants:{variant:"default"}}),Card=({variant="default",hoverable=!1,asButton=!1,href,disableMotion=!1,className,children,ref,...props})=>{const classes=(0,utils.cn)(cardVariants({variant}),(hoverable||href||asButton)&&"cursor-pointer",className),motionVariants=hoverable&&!disableMotion?{initial:"rest",whileHover:"hover",variants:cardHover,style:{willChange:"transform"}}:{};return href?(0,jsx_runtime.jsx)(proxy.P.a,{className:classes,href,ref,...motionVariants,children}):asButton?(0,jsx_runtime.jsx)(proxy.P.button,{className:classes,ref,type:"button",...motionVariants,children}):disableMotion?(0,jsx_runtime.jsx)("div",{className:classes,ref,...props,children}):(0,jsx_runtime.jsx)(proxy.P.div,{className:classes,ref,...motionVariants,children})};Card.displayName="Card";const CardHeader=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pb-4",className),ref,...props});CardHeader.displayName="CardHeader";const CardContent=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("p-6 pt-0",className),ref,...props});CardContent.displayName="CardContent";const CardFooter=({className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("border-t border-black/5 p-6 pt-4 dark:border-white/10",className),ref,...props});CardFooter.displayName="CardFooter";const CardImage=({aspectRatio="16/9",className,ref,...props})=>(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("relative overflow-hidden",className),ref,style:{aspectRatio},...props});CardImage.displayName="CardImage";try{Card.displayName="Card",Card.__docgenInfo={description:"Card - Flexible container with optional animations",displayName:"Card",props:{variant:{defaultValue:{value:"default"},description:"Visual variant",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"elevated"'},{value:'"outlined"'},{value:'"glass"'}]}},hoverable:{defaultValue:{value:"false"},description:"Enable hover lift effect",name:"hoverable",required:!1,type:{name:"boolean"}},asButton:{defaultValue:{value:"false"},description:"Clickable card (renders as button)",name:"asButton",required:!1,type:{name:"boolean"}},href:{defaultValue:null,description:"Link href (renders as anchor)",name:"href",required:!1,type:{name:"string"}},disableMotion:{defaultValue:{value:"false"},description:"Disable motion animations",name:"disableMotion",required:!1,type:{name:"boolean"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#Card"]={docgenInfo:Card.__docgenInfo,name:"Card",path:"src/components/ui/card.tsx#Card"})}catch(__react_docgen_typescript_loader_error){}try{CardHeader.displayName="CardHeader",CardHeader.__docgenInfo={description:"CardHeader - Card header section",displayName:"CardHeader",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardHeader"]={docgenInfo:CardHeader.__docgenInfo,name:"CardHeader",path:"src/components/ui/card.tsx#CardHeader"})}catch(__react_docgen_typescript_loader_error){}try{CardContent.displayName="CardContent",CardContent.__docgenInfo={description:"CardContent - Card main content section",displayName:"CardContent",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardContent"]={docgenInfo:CardContent.__docgenInfo,name:"CardContent",path:"src/components/ui/card.tsx#CardContent"})}catch(__react_docgen_typescript_loader_error){}try{CardFooter.displayName="CardFooter",CardFooter.__docgenInfo={description:"CardFooter - Card footer section",displayName:"CardFooter",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardFooter"]={docgenInfo:CardFooter.__docgenInfo,name:"CardFooter",path:"src/components/ui/card.tsx#CardFooter"})}catch(__react_docgen_typescript_loader_error){}try{CardImage.displayName="CardImage",CardImage.__docgenInfo={description:"CardImage - Card image section",displayName:"CardImage",props:{aspectRatio:{defaultValue:{value:"16/9"},description:"",name:"aspectRatio",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLDivElement>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ui/card.tsx#CardImage"]={docgenInfo:CardImage.__docgenInfo,name:"CardImage",path:"src/components/ui/card.tsx#CardImage"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function cn(...classes){return classes.filter(Boolean).join(" ")}__webpack_require__.d(__webpack_exports__,{cn:()=>cn})}}]);