"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[4931,24081],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./node_modules/next-intl/dist/esm/production/react-client/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c3:()=>e});var use_intl__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/use-intl/dist/esm/production/react.js");function o(r,t){return(...r)=>{try{return t(...r)}catch{throw new Error(void 0)}}}const e=o(0,use_intl__WEBPACK_IMPORTED_MODULE_0__.c3);o(0,use_intl__WEBPACK_IMPORTED_MODULE_0__.kc)},"./src/components/bookings/pro-financial-summary.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>pro_financial_summary_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),react_client=__webpack_require__("./node_modules/next-intl/dist/esm/production/react-client/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");function formatCOP(value){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(value)}function isSameMonth(dateInput,reference){if(!dateInput)return!1;const date=new Date(dateInput);return date.getUTCFullYear()===reference.getUTCFullYear()&&date.getUTCMonth()===reference.getUTCMonth()}function ProFinancialSummary({bookings,connectAccountId,connectStatus}){const t=(0,react_client.c3)("dashboard.pro.financialSummary"),[onboardingError,setOnboardingError]=(0,react.useState)(null),[isPending,startTransition]=(0,react.useTransition)(),totals=(0,react.useMemo)(()=>{const summary={captured:0,authorized:0,pending:0,canceled:0,thisMonthCaptured:0,thisMonthAuthorized:0},reference=new Date;for(const booking of bookings){const captured=booking.amount_captured??0,authorized=booking.amount_authorized??0,estimated=booking.amount_estimated??0;switch(booking.status){case"completed":summary.captured+=captured||authorized||estimated,isSameMonth(booking.scheduled_start??booking.created_at,reference)&&(summary.thisMonthCaptured+=captured||authorized||estimated);break;case"authorized":summary.authorized+=authorized||estimated,isSameMonth(booking.scheduled_start??booking.created_at,reference)&&(summary.thisMonthAuthorized+=authorized||estimated);break;case"pending_payment":summary.pending+=estimated;break;case"canceled":summary.canceled+=authorized||estimated}}return summary},[bookings]),noData=0===bookings.length,normalizedStatus=(connectStatus??"not_started").toLowerCase(),needsConnect=!(connectAccountId&&["submitted","complete","verified"].includes(normalizedStatus));return(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-[#e2e8f0] bg-[#f8fafc]/90 p-6 shadow-sm",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5 text-[#64748b]",icon:index_min.cqM}),(0,jsx_runtime.jsx)("h3",{className:"font-semibold text-[#0f172a] text-lg",children:t("title")})]}),needsConnect?(0,jsx_runtime.jsx)("button",{className:"inline-flex items-center rounded-md bg-[#64748b] px-3 py-1.5 font-semibold text-[#f8fafc] text-xs shadow-sm transition hover:bg-[#64748b] disabled:cursor-not-allowed disabled:opacity-70",disabled:isPending,onClick:()=>{setOnboardingError(null),startTransition(async()=>{try{const response=await fetch("/api/pro/stripe/connect",{method:"POST"});if(!response.ok){const payload=await response.json().catch(()=>({}));throw new Error(payload.error??"Unable to start onboarding")}const payload=await response.json();window.location.href=payload.url}catch(error){setOnboardingError(error instanceof Error?error.message:"Unexpected error starting onboarding")}})},type:"button",children:t(isPending?"stripe.opening":"stripe.setup")}):null]}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-[#94a3b8] text-sm",children:t("description")}),(0,jsx_runtime.jsxs)("p",{className:"mt-2 font-medium text-[#94a3b8] text-xs",children:[t("stripe.statusLabel")," ",(0,jsx_runtime.jsx)("span",{className:"text-[#64748b]",children:t(needsConnect?"stripe.actionRequired":"stripe.connected")})]}),onboardingError?(0,jsx_runtime.jsx)("p",{className:"mt-3 text-[#64748b] text-xs",children:onboardingError}):null,noData?(0,jsx_runtime.jsx)("p",{className:"mt-6 text-[#94a3b8] text-sm",children:t("emptyState")}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("dl",{className:"mt-6 grid gap-3 sm:grid-cols-2",children:[(0,jsx_runtime.jsx)(SummaryCard,{accent:"text-[#64748b]",amount:totals.captured,description:t("cards.availableAfterCompletion.description"),icon:index_min.cqM,title:t("cards.availableAfterCompletion.title"),tone:"bg-[#f8fafc]"}),(0,jsx_runtime.jsx)(SummaryCard,{accent:"text-[#64748b]",amount:totals.authorized,description:t("cards.activeHolds.description"),icon:index_min.fNY,title:t("cards.activeHolds.title"),tone:"bg-[#f8fafc]"})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-6 rounded-lg border border-[#e2e8f0] bg-[#f8fafc] p-4 text-[#94a3b8] text-xs",children:[(0,jsx_runtime.jsx)("p",{className:"font-semibold text-[#0f172a]",children:t("thisMonth")}),(0,jsx_runtime.jsxs)("div",{className:"mt-2 grid gap-3 sm:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-xs uppercase tracking-wide",children:t("metrics.capturedPayouts")}),(0,jsx_runtime.jsx)("p",{className:"font-semibold text-[#0f172a] text-sm",children:formatCOP(totals.thisMonthCaptured)})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{className:"text-[#94a3b8] text-xs uppercase tracking-wide",children:t("metrics.upcomingHolds")}),(0,jsx_runtime.jsx)("p",{className:"font-semibold text-[#0f172a] text-sm",children:formatCOP(totals.thisMonthAuthorized)})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-6 space-y-3 text-[#94a3b8] text-sm",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[#e2e8f0] bg-[#f8fafc]/80 px-3 py-2",children:[(0,jsx_runtime.jsx)("span",{children:t("metrics.pendingRequests")}),(0,jsx_runtime.jsx)("span",{children:formatCOP(totals.pending)})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-[#e2e8f0] bg-[#f8fafc]/80 px-3 py-2",children:[(0,jsx_runtime.jsxs)("span",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4 text-[#64748b]",icon:index_min.msl}),t("metrics.holdsReleased")]}),(0,jsx_runtime.jsx)("span",{children:formatCOP(totals.canceled)})]})]})]})]})}function SummaryCard({icon,title,amount,description,tone,accent}){return(0,jsx_runtime.jsxs)("div",{className:`rounded-lg border border-[#e2e8f0] ${tone} p-4`,children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:`h-4 w-4 ${accent}`,icon}),(0,jsx_runtime.jsx)("dt",{className:"font-semibold text-[#94a3b8] text-xs uppercase tracking-wide",children:title})]}),(0,jsx_runtime.jsx)("dd",{className:"mt-2 font-semibold text-[#0f172a] text-xl",children:formatCOP(amount)}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-[#94a3b8] text-xs",children:description})]})}try{ProFinancialSummary.displayName="ProFinancialSummary",ProFinancialSummary.__docgenInfo={description:"",displayName:"ProFinancialSummary",props:{bookings:{defaultValue:null,description:"",name:"bookings",required:!0,type:{name:"FinancialBooking[]"}},connectAccountId:{defaultValue:null,description:"",name:"connectAccountId",required:!0,type:{name:"string"}},connectStatus:{defaultValue:null,description:"",name:"connectStatus",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/bookings/pro-financial-summary.tsx#ProFinancialSummary"]={docgenInfo:ProFinancialSummary.__docgenInfo,name:"ProFinancialSummary",path:"src/components/bookings/pro-financial-summary.tsx#ProFinancialSummary"})}catch(__react_docgen_typescript_loader_error){}const pro_financial_summary_stories={title:"Bookings/ProFinancialSummary",component:ProFinancialSummary,parameters:{layout:"padded"},tags:["autodocs"]},Default={},__namedExportsOrder=["Default"]}}]);