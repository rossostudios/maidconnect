"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[86081],{"./src/components/bookings/reschedule-booking-modal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{RescheduleBookingModal:()=>RescheduleBookingModal});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),next_intl__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next-intl/dist/esm/production/react-client/index.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_components_shared_form_modal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/shared/form-modal.tsx"),_hooks_use_api_mutation__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/hooks/use-api-mutation.ts"),_hooks_use_modal_form__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/hooks/use-modal-form.ts");function RescheduleBookingModal({isOpen,onClose,booking}){const t=(0,next_intl__WEBPACK_IMPORTED_MODULE_1__.c3)("dashboard.customer.rescheduleBookingModal"),form=(0,_hooks_use_modal_form__WEBPACK_IMPORTED_MODULE_5__.F)({initialData:(()=>{if(booking.scheduled_start){const currentStart=new Date(booking.scheduled_start);return{newDate:currentStart.toISOString().split("T")[0]||"",newTime:currentStart.toTimeString().slice(0,5)}}return{newDate:"",newTime:""}})(),resetOnClose:!0});(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{if(isOpen&&booking.scheduled_start){const currentStart=new Date(booking.scheduled_start),dateStr=currentStart.toISOString().split("T")[0]||"",timeStr=currentStart.toTimeString().slice(0,5);form.setFormData({newDate:dateStr,newTime:timeStr})}},[isOpen,booking.scheduled_start,form.setFormData]),(0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(()=>{isOpen||form.reset()},[isOpen,form.reset]);const rescheduleMutation=(0,_hooks_use_api_mutation__WEBPACK_IMPORTED_MODULE_4__.L)({url:"/api/bookings/reschedule",method:"POST",refreshOnSuccess:!0});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_components_shared_form_modal__WEBPACK_IMPORTED_MODULE_3__.k,{cancelLabel:t("buttons.cancel"),closeOnBackdropClick:!rescheduleMutation.isLoading,closeOnEscape:!rescheduleMutation.isLoading,isOpen,isSubmitting:rescheduleMutation.isLoading,onClose,onSubmit:async()=>{const{newDate,newTime}=form.formData;if(!newDate||!newTime)return void form.setError(t("validation.selectDateTime"));const newScheduledStart=new Date(`${newDate}T${newTime}`).toISOString();if(new Date(newScheduledStart)<=new Date)form.setError(t("validation.futureDateRequired"));else try{const result=await rescheduleMutation.mutate({bookingId:booking.id,newScheduledStart,newDurationMinutes:booking.duration_minutes});form.setMessage(result.message||t("success.rescheduled"),"success"),setTimeout(()=>{onClose()},2e3)}catch(error){form.setError(error instanceof Error?error.message:t("error.failed"))}},size:"md",submitLabel:t("buttons.reschedule"),title:t("title"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"text-base text-[#94a3b8]",children:booking.service_name||"Service"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"rounded-2xl border border-[#e2e8f0] bg-[#f8fafc] p-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-semibold text-[#94a3b8] text-xs uppercase tracking-[0.2em]",children:t("currentScheduleLabel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mt-2 text-base text-[#0f172a]",children:booking.scheduled_start?new Date(booking.scheduled_start).toLocaleString("es-CO",{dateStyle:"medium",timeStyle:"short"}):"â€”"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"space-y-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("label",{className:"mb-2 block font-semibold text-base text-[#0f172a]",htmlFor:"newDate",children:t("newDateLabel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{className:"w-full rounded-xl border border-[#e2e8f0] px-4 py-4 text-base shadow-sm focus:border-[#64748b] focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"newDate",min:(new Date).toISOString().split("T")[0],onChange:e=>form.updateField("newDate",e.target.value),type:"date",value:form.formData.newDate})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("label",{className:"mb-2 block font-semibold text-base text-[#0f172a]",htmlFor:"newTime",children:t("newTimeLabel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("input",{className:"w-full rounded-xl border border-[#e2e8f0] px-4 py-4 text-base shadow-sm focus:border-[#64748b] focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"newTime",onChange:e=>form.updateField("newTime",e.target.value),type:"time",value:form.formData.newTime})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"rounded-2xl border border-[#e2e8f0] bg-[#f8fafc] p-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"font-semibold text-base text-[#64748b]",children:t("notice.title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mt-3 text-base text-[#64748b] leading-relaxed",children:t("notice.description")})]}),form.message&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"rounded-2xl p-4 text-base "+(form.success,"bg-[#64748b]/10 text-[#64748b]"),children:form.message})]})}try{RescheduleBookingModal.displayName="RescheduleBookingModal",RescheduleBookingModal.__docgenInfo={description:"",displayName:"RescheduleBookingModal",props:{isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},booking:{defaultValue:null,description:"",name:"booking",required:!0,type:{name:"{ id: string; service_name: string; scheduled_start: string; duration_minutes: number; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/bookings/reschedule-booking-modal.tsx#RescheduleBookingModal"]={docgenInfo:RescheduleBookingModal.__docgenInfo,name:"RescheduleBookingModal",path:"src/components/bookings/reschedule-booking-modal.tsx#RescheduleBookingModal"})}catch(__react_docgen_typescript_loader_error){}}}]);