(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,89674],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./node_modules/next/dist/shared/lib/dynamic.js":(module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),function _export(target,all){for(var name in all)Object.defineProperty(target,name,{enumerable:!0,get:all[name]})}(exports,{default:function(){return dynamic},noSSR:function(){return noSSR}});const _interop_require_default=__webpack_require__("./node_modules/@swc/helpers/cjs/_interop_require_default.cjs"),_jsxruntime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_loadablesharedruntime=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_interop_require_default._(__webpack_require__("./node_modules/next/dist/shared/lib/loadable.shared-runtime.js"))),isServerSide="undefined"==typeof window;function convertModule(mod){return{default:mod?.default||mod}}function noSSR(LoadableInitializer,loadableOptions){if(delete loadableOptions.webpack,delete loadableOptions.modules,!isServerSide)return LoadableInitializer(loadableOptions);const Loading=loadableOptions.loading;return()=>(0,_jsxruntime.jsx)(Loading,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}function dynamic(dynamicOptions,options){let loadableFn=_loadablesharedruntime.default,loadableOptions={loading:({error,isLoading,pastDelay})=>null};dynamicOptions instanceof Promise?loadableOptions.loader=()=>dynamicOptions:"function"==typeof dynamicOptions?loadableOptions.loader=dynamicOptions:"object"==typeof dynamicOptions&&(loadableOptions={...loadableOptions,...dynamicOptions}),loadableOptions={...loadableOptions,...options};const loaderFn=loadableOptions.loader;return loadableOptions.loadableGenerated&&(loadableOptions={...loadableOptions,...loadableOptions.loadableGenerated},delete loadableOptions.loadableGenerated),"boolean"!=typeof loadableOptions.ssr||loadableOptions.ssr?loadableFn({...loadableOptions,loader:()=>null!=loaderFn?loaderFn().then(convertModule):Promise.resolve(convertModule(()=>null))}):(delete loadableOptions.webpack,delete loadableOptions.modules,noSSR(loadableFn,loadableOptions))}("function"==typeof exports.default||"object"==typeof exports.default&&null!==exports.default)&&void 0===exports.default.__esModule&&(Object.defineProperty(exports.default,"__esModule",{value:!0}),Object.assign(exports.default,exports),module.exports=exports.default)},"./node_modules/next/dist/shared/lib/loadable-context.shared-runtime.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"LoadableContext",{enumerable:!0,get:function(){return LoadableContext}});const LoadableContext=__webpack_require__("./node_modules/@swc/helpers/cjs/_interop_require_default.cjs")._(__webpack_require__("./node_modules/next/dist/compiled/react/index.js")).default.createContext(null)},"./node_modules/next/dist/shared/lib/loadable.shared-runtime.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return _default}});const _react=__webpack_require__("./node_modules/@swc/helpers/cjs/_interop_require_default.cjs")._(__webpack_require__("./node_modules/next/dist/compiled/react/index.js")),_loadablecontextsharedruntime=__webpack_require__("./node_modules/next/dist/shared/lib/loadable-context.shared-runtime.js");const ALL_INITIALIZERS=[],READY_INITIALIZERS=[];let initialized=!1;function load(loader){let promise=loader(),state={loading:!0,loaded:null,error:null};return state.promise=promise.then(loaded=>(state.loading=!1,state.loaded=loaded,loaded)).catch(err=>{throw state.loading=!1,state.error=err,err}),state}function createLoadableComponent(loadFn,options){let opts=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},options),subscription=null;function init(){if(!subscription){const sub=new LoadableSubscription(loadFn,opts);subscription={getCurrentValue:sub.getCurrentValue.bind(sub),subscribe:sub.subscribe.bind(sub),retry:sub.retry.bind(sub),promise:sub.promise.bind(sub)}}return subscription.promise()}if("undefined"==typeof window&&ALL_INITIALIZERS.push(init),!initialized&&"undefined"!=typeof window){const moduleIds=opts.webpack?opts.webpack():opts.modules;moduleIds&&READY_INITIALIZERS.push(ids=>{for(const moduleId of moduleIds)if(ids.includes(moduleId))return init()})}function LoadableComponent(props,ref){!function useLoadableModule(){init();const context=_react.default.useContext(_loadablecontextsharedruntime.LoadableContext);context&&Array.isArray(opts.modules)&&opts.modules.forEach(moduleName=>{context(moduleName)})}();const state=_react.default.useSyncExternalStore(subscription.subscribe,subscription.getCurrentValue,subscription.getCurrentValue);return _react.default.useImperativeHandle(ref,()=>({retry:subscription.retry}),[]),_react.default.useMemo(()=>state.loading||state.error?_react.default.createElement(opts.loading,{isLoading:state.loading,pastDelay:state.pastDelay,timedOut:state.timedOut,error:state.error,retry:subscription.retry}):state.loaded?_react.default.createElement(function resolve(obj){return obj&&obj.default?obj.default:obj}(state.loaded),props):null,[props,state])}return LoadableComponent.preload=()=>init(),LoadableComponent.displayName="LoadableComponent",_react.default.forwardRef(LoadableComponent)}class LoadableSubscription{constructor(loadFn,opts){this._loadFn=loadFn,this._opts=opts,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};const{_res:res,_opts:opts}=this;res.loading&&("number"==typeof opts.delay&&(0===opts.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},opts.delay)),"number"==typeof opts.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},opts.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(_err=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(partial){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...partial},this._callbacks.forEach(callback=>callback())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(callback){return this._callbacks.add(callback),()=>{this._callbacks.delete(callback)}}}function Loadable(opts){return createLoadableComponent(load,opts)}function flushInitializers(initializers,ids){let promises=[];for(;initializers.length;){let init=initializers.pop();promises.push(init(ids))}return Promise.all(promises).then(()=>{if(initializers.length)return flushInitializers(initializers,ids)})}Loadable.preloadAll=()=>new Promise((resolveInitializers,reject)=>{flushInitializers(ALL_INITIALIZERS).then(resolveInitializers,reject)}),Loadable.preloadReady=(ids=[])=>new Promise(resolvePreload=>{const res=()=>(initialized=!0,resolvePreload());flushInitializers(READY_INITIALIZERS,ids).then(res,res)}),"undefined"!=typeof window&&(window.__NEXT_PRELOADREADY=Loadable.preloadReady);const _default=Loadable},"./node_modules/next/dynamic.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/next/dist/shared/lib/dynamic.js")},"./src/components/changelog/changelog-banner.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>changelog_banner_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),dynamic=__webpack_require__("./node_modules/next/dynamic.js"),dynamic_default=__webpack_require__.n(dynamic),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");const ChangelogModal=dynamic_default()(()=>Promise.all([__webpack_require__.e(65251),__webpack_require__.e(78520),__webpack_require__.e(82754),__webpack_require__.e(84074),__webpack_require__.e(98212)]).then(__webpack_require__.bind(__webpack_require__,"./src/components/changelog/changelog-modal.tsx")).then(mod=>mod.ChangelogModal),{loadableGenerated:{webpack:()=>["./src/components/changelog/changelog-modal.tsx"]},ssr:!1});function ChangelogBanner(){const{changelog,hasViewed,markAsRead}=function useLatestChangelog(){const[changelog,setChangelog]=(0,react.useState)(null),[hasViewed,setHasViewed]=(0,react.useState)(!1),[isLoading,setIsLoading]=(0,react.useState)(!0),[error,setError]=(0,react.useState)(null),fetchLatestChangelog=(0,react.useCallback)(async()=>{try{const response=await fetch("/api/changelog/latest");if(!response.ok)throw new Error("Failed to fetch latest changelog");const data=await response.json();setChangelog(data.changelog||null),setHasViewed(data.hasViewed),setError(null)}catch(err){setError(err instanceof Error?err.message:"Unknown error")}finally{setIsLoading(!1)}},[]);(0,react.useEffect)(()=>{fetchLatestChangelog()},[fetchLatestChangelog]);const markAsRead=(0,react.useCallback)(async()=>{if(changelog)try{(await fetch("/api/changelog/mark-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({changelogId:changelog.id})})).ok&&setHasViewed(!0)}catch(err){console.error("Error marking changelog as read:",err)}},[changelog]),refresh=(0,react.useCallback)(()=>{fetchLatestChangelog()},[fetchLatestChangelog]);return{changelog,hasViewed,isLoading,error,markAsRead,refresh}}(),[isDismissed,setIsDismissed]=(0,react.useState)(!1),[isModalOpen,setIsModalOpen]=(0,react.useState)(!1);if(!changelog||hasViewed||isDismissed)return null;const handleDismiss=async()=>{setIsDismissed(!0),await markAsRead()};return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{className:"sticky top-0 z-40 border-[#e2e8f0] border-b bg-gradient-to-r from-[#64748b]/10 to-[#64748b]/10 px-4 py-3 shadow-sm",children:(0,jsx_runtime.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-4",children:[(0,jsx_runtime.jsxs)("button",{className:"group flex flex-1 items-center gap-3 text-left transition hover:opacity-80",onClick:()=>{setIsModalOpen(!0)},type:"button",children:[(0,jsx_runtime.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-[#64748b]/10",children:(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4 text-[#64748b]",icon:index_min.QTh})}),(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[(0,jsx_runtime.jsxs)("p",{className:"font-semibold text-[#0f172a] text-sm sm:text-base",children:[(0,jsx_runtime.jsx)("span",{className:"hidden sm:inline",children:"New update: "}),changelog.title]}),(0,jsx_runtime.jsxs)("p",{className:"text-[#94a3b8] text-xs sm:text-sm",children:["Sprint ",changelog.sprint_number," â€¢"," ",new Date(changelog.published_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),(0,jsx_runtime.jsx)("span",{className:"hidden rounded-full border border-[#64748b] px-3 py-1 font-medium text-[#64748b] text-sm transition group-hover:bg-[#64748b] group-hover:text-[#f8fafc] sm:inline-block",children:"View Details"})]}),(0,jsx_runtime.jsx)("button",{"aria-label":"Dismiss",className:"rounded-full p-1.5 text-[#94a3b8] transition hover:bg-[#f8fafc]/50 hover:text-[#0f172a]",onClick:handleDismiss,type:"button",children:(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5",icon:index_min.bJi})})]})}),(0,jsx_runtime.jsx)(ChangelogModal,{changelog,isOpen:isModalOpen,onClose:()=>{setIsModalOpen(!1),handleDismiss()}})]})}try{ChangelogBanner.displayName="ChangelogBanner",ChangelogBanner.__docgenInfo={description:"Banner notification for new changelog entries\nShows at the top of the page when there's an unread update\nCan be dismissed or clicked to view details",displayName:"ChangelogBanner",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/changelog/changelog-banner.tsx#ChangelogBanner"]={docgenInfo:ChangelogBanner.__docgenInfo,name:"ChangelogBanner",path:"src/components/changelog/changelog-banner.tsx#ChangelogBanner"})}catch(__react_docgen_typescript_loader_error){}const changelog_banner_stories={title:"Changelog/ChangelogBanner",component:ChangelogBanner,parameters:{layout:"padded"},tags:["autodocs"]},Default={},__namedExportsOrder=["Default"]}}]);