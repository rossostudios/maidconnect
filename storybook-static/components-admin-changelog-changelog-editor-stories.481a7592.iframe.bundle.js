"use strict";(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[24081,88001],{"./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HugeiconsIcon});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none"},HugeiconsIcon=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)(({color="currentColor",size=24,strokeWidth,absoluteStrokeWidth=!1,className="",altIcon,showAlt=!1,icon,primaryColor,secondaryColor,disableSecondaryOpacity=!1,...rest},ref)=>{const calculatedStrokeWidth=void 0!==strokeWidth?absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth:void 0,strokeProps=void 0!==calculatedStrokeWidth?{strokeWidth:calculatedStrokeWidth,stroke:"currentColor"}:{},elementProps={ref,...defaultAttributes,width:size,height:size,color:primaryColor||color,className,...strokeProps,...rest},svgChildren=[...showAlt&&altIcon?altIcon:icon].sort(([,a],[,b])=>{const hasOpacityA=void 0!==a.opacity;return void 0!==b.opacity?1:hasOpacityA?-1:0}).map(([tag,attrs])=>{const isSecondaryPath=void 0!==attrs.opacity,pathOpacity=isSecondaryPath&&!disableSecondaryOpacity?attrs.opacity:void 0,fillProps=secondaryColor?{...void 0!==attrs.stroke?{stroke:isSecondaryPath?secondaryColor:primaryColor||color}:{fill:isSecondaryPath?secondaryColor:primaryColor||color}}:{};return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)(tag,{...attrs,...strokeProps,...fillProps,opacity:pathOpacity,key:attrs.key})});return(0,react__WEBPACK_IMPORTED_MODULE_0__.createElement)("svg",elementProps,svgChildren)});HugeiconsIcon.displayName="HugeiconsIcon"},"./src/components/admin/changelog/changelog-editor.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>changelog_editor_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),sanitize=__webpack_require__("./src/lib/sanitize.ts");const categoryOptions=[{value:"features",label:"Features",icon:index_min.QTh,color:"text-slate-900 dark:text-slate-100"},{value:"improvements",label:"Improvements",icon:index_min.gXB,color:"text-slate-900 dark:text-slate-100"},{value:"fixes",label:"Fixes",icon:index_min.Fbp,color:"text-slate-900 dark:text-slate-100"},{value:"security",label:"Security",icon:index_min.IEb,color:"text-slate-900 dark:text-slate-100"},{value:"design",label:"Design",icon:index_min.Ql3,color:"text-slate-900 dark:text-slate-100"}],audienceOptions=[{value:"all",label:"All Users"},{value:"customer",label:"Customers"},{value:"professional",label:"Professionals"},{value:"admin",label:"Admins"}];function ChangelogEditor({initialData,changelogId,mode}){const router=(0,navigation.useRouter)(),[saving,setSaving]=(0,react.useState)(!1),[error,setError]=(0,react.useState)(null),[showPreview,setShowPreview]=(0,react.useState)(!1),[formData,setFormData]=(0,react.useState)({sprint_number:initialData?.sprint_number||1,title:initialData?.title||"",slug:initialData?.slug||"",summary:initialData?.summary||"",content:initialData?.content||"",published_at:initialData?.published_at?new Date(initialData.published_at).toISOString().split("T")[0]||"":(new Date).toISOString().split("T")[0]||"",categories:initialData?.categories||[],tags:Array.isArray(initialData?.tags)?initialData.tags.join(", "):initialData?.tags||"",target_audience:initialData?.target_audience||["all"],featured_image_url:initialData?.featured_image_url||"",visibility:initialData?.visibility||"draft"}),generateSlug=(0,react.useCallback)(title=>title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),[]),handleSubmit=async(e,visibility)=>{e.preventDefault(),setError(null),setSaving(!0);try{const tagsArray=formData.tags.split(",").map(tag=>tag.trim()).filter(Boolean),payload={...formData,tags:tagsArray,visibility,published_at:new Date(formData.published_at).toISOString()},url="create"===mode?"/api/admin/changelog":`/api/admin/changelog/${changelogId}`,method="create"===mode?"POST":"PATCH",response=await fetch(url,{method,headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});if(!response.ok){const data=await response.json();throw new Error(data.error||"Failed to save changelog")}router.push("/admin/changelog"),router.refresh()}catch(err){setError(err instanceof Error?err.message:"An error occurred")}finally{setSaving(!1)}};return(0,jsx_runtime.jsxs)("div",{className:"mx-auto max-w-4xl",children:[error&&(0,jsx_runtime.jsx)("div",{className:"mb-6 rounded-2xl border border-slate-900 dark:border-slate-100/30 bg-slate-900 dark:bg-slate-100/10 p-4 text-slate-900 dark:text-slate-100 text-sm",children:error}),(0,jsx_runtime.jsxs)("form",{className:"space-y-6",children:[(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsx)("h3",{className:"mb-4 font-bold text-slate-900 dark:text-slate-100 text-lg",children:"Basic Information"}),(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"sprint_number",children:"Sprint Number *"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"sprint_number",min:"1",onChange:e=>setFormData({...formData,sprint_number:Number.parseInt(e.target.value,10)||1}),required:!0,type:"number",value:formData.sprint_number})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"title",children:"Title *"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"title",onChange:e=>{return title=e.target.value,void setFormData(prev=>({...prev,title,slug:generateSlug(title)}));var title},placeholder:"e.g., Enhanced Search and New Dashboard Features",required:!0,type:"text",value:formData.title})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"slug",children:"Slug *"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-4 py-3 font-mono text-slate-600 dark:text-slate-400 text-sm focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"slug",onChange:e=>setFormData({...formData,slug:e.target.value}),placeholder:"auto-generated-from-title",required:!0,type:"text",value:formData.slug}),(0,jsx_runtime.jsx)("p",{className:"mt-1 text-slate-600 dark:text-slate-400 text-xs",children:"URL-friendly version of the title (auto-generated)"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"summary",children:"Summary"}),(0,jsx_runtime.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"summary",onChange:e=>setFormData({...formData,summary:e.target.value}),placeholder:"Brief overview of this update (shown in list view)",rows:3,value:formData.summary})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"published_at",children:"Published Date *"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"published_at",onChange:e=>setFormData({...formData,published_at:e.target.value}),required:!0,type:"date",value:formData.published_at})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,jsx_runtime.jsx)("h3",{className:"font-bold text-slate-900 dark:text-slate-100 text-lg",children:"Content *"}),(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-lg border border-slate-200 dark:border-slate-800 px-3 py-1.5 text-slate-600 dark:text-slate-400 text-sm transition hover:border-slate-900 dark:border-slate-100",onClick:()=>setShowPreview(!showPreview),type:"button",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.tCQ}),showPreview?"Edit":"Preview"]})]}),showPreview?(0,jsx_runtime.jsx)("div",{className:"prose prose-lg max-w-none rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",dangerouslySetInnerHTML:{__html:(0,sanitize.Ro)(formData.content)}}):(0,jsx_runtime.jsx)("textarea",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 font-mono text-slate-900 dark:text-slate-100 text-sm focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"content",onChange:e=>setFormData({...formData,content:e.target.value}),placeholder:"Write your changelog content here (supports HTML)...",required:!0,rows:15,value:formData.content}),(0,jsx_runtime.jsx)("p",{className:"mt-2 text-slate-600 dark:text-slate-400 text-xs",children:"Supports HTML formatting"})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsx)("h3",{className:"mb-4 font-bold text-slate-900 dark:text-slate-100 text-lg",children:"Categories"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-3",children:categoryOptions.map(option=>{const isSelected=formData.categories.includes(option.value);return(0,jsx_runtime.jsxs)("button",{className:"flex items-center gap-2 rounded-full border-2 px-4 py-2 font-medium text-sm transition "+(isSelected?"border-slate-900 dark:border-slate-100 bg-slate-900 dark:bg-slate-100 text-white dark:text-slate-950":"border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-400 hover:border-slate-900 dark:border-slate-100"),onClick:()=>{return category=option.value,void setFormData(prev=>({...prev,categories:prev.categories.includes(category)?prev.categories.filter(c=>c!==category):[...prev.categories,category]}));var category},type:"button",children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:option.icon}),option.label]},option.value)})})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsx)("h3",{className:"mb-4 font-bold text-slate-900 dark:text-slate-100 text-lg",children:"Metadata"}),(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"tags",children:"Tags"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"tags",onChange:e=>setFormData({...formData,tags:e.target.value}),placeholder:"performance, ui, mobile (comma-separated)",type:"text",value:formData.tags})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("div",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",children:"Target Audience"}),(0,jsx_runtime.jsx)("div",{className:"flex flex-wrap gap-2",children:audienceOptions.map(option=>{const isSelected=formData.target_audience.includes(option.value);return(0,jsx_runtime.jsx)("button",{className:"rounded-lg border-2 px-3 py-1.5 font-medium text-sm transition "+(isSelected?"border-slate-900 dark:border-slate-100 bg-slate-900 dark:bg-slate-100/20 text-slate-900 dark:text-slate-100":"border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-400 hover:border-slate-900 dark:border-slate-100"),onClick:()=>{return audience=option.value,void setFormData(prev=>({...prev,target_audience:prev.target_audience.includes(audience)?prev.target_audience.filter(a=>a!==audience):[...prev.target_audience,audience]}));var audience},type:"button",children:option.label},option.value)})})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"mb-2 block font-medium text-slate-900 dark:text-slate-100 text-sm",htmlFor:"featured_image_url",children:"Featured Image URL"}),(0,jsx_runtime.jsx)("input",{className:"w-full rounded-xl border border-slate-200 dark:border-slate-800 px-4 py-3 text-slate-900 dark:text-slate-100 focus:border-slate-900 dark:border-slate-100 focus:outline-none focus:ring-2 focus:ring-[#64748b]/20",id:"featured_image_url",onChange:e=>setFormData({...formData,featured_image_url:e.target.value}),placeholder:"https://example.com/image.jpg",type:"url",value:formData.featured_image_url})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 p-6",children:[(0,jsx_runtime.jsx)("button",{className:"rounded-full border border-slate-200 dark:border-slate-800 px-6 py-2.5 font-semibold text-slate-600 dark:text-slate-400 transition hover:border-slate-900 dark:border-slate-100",disabled:saving,onClick:()=>router.back(),type:"button",children:"Cancel"}),(0,jsx_runtime.jsxs)("div",{className:"flex gap-3",children:[(0,jsx_runtime.jsx)("button",{className:"flex items-center gap-2 rounded-full border-2 border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 px-6 py-2.5 font-semibold text-slate-900 dark:text-slate-100 transition hover:border-slate-900 dark:border-slate-100 disabled:opacity-50",disabled:saving,onClick:e=>handleSubmit(e,"draft"),type:"button",children:saving?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4 animate-spin",icon:index_min.H5m}),"Saving..."]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.NXE}),"Save Draft"]})}),(0,jsx_runtime.jsx)("button",{className:"flex items-center gap-2 rounded-full bg-slate-900 dark:bg-slate-100 px-6 py-2.5 font-semibold text-white dark:text-slate-950 transition hover:bg-slate-900 dark:bg-slate-100 disabled:opacity-50",disabled:saving,onClick:e=>handleSubmit(e,"published"),type:"button",children:saving?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4 animate-spin",icon:index_min.H5m}),"Publishing..."]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-4 w-4",icon:index_min.QTh}),"Publish"]})})]})]})]})]})}try{ChangelogEditor.displayName="ChangelogEditor",ChangelogEditor.__docgenInfo={description:"",displayName:"ChangelogEditor",props:{initialData:{defaultValue:null,description:"",name:"initialData",required:!1,type:{name:"Partial<ChangelogFormData>"}},changelogId:{defaultValue:null,description:"",name:"changelogId",required:!1,type:{name:"string"}},mode:{defaultValue:null,description:"",name:"mode",required:!0,type:{name:"enum",value:[{value:'"create"'},{value:'"edit"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/admin/changelog/changelog-editor.tsx#ChangelogEditor"]={docgenInfo:ChangelogEditor.__docgenInfo,name:"ChangelogEditor",path:"src/components/admin/changelog/changelog-editor.tsx#ChangelogEditor"})}catch(__react_docgen_typescript_loader_error){}const changelog_editor_stories={title:"Admin/Changelog Editor",component:ChangelogEditor,parameters:{layout:"centered"},tags:["autodocs"]},Default={args:{}},__namedExportsOrder=["Default"]},"./src/lib/sanitize.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ro:()=>sanitizeRichContent});var isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/isomorphic-dompurify/browser.js"),isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0__);__webpack_require__("./node_modules/console-browserify/index.js");function sanitizeRichContent(dirty){return String(isomorphic_dompurify__WEBPACK_IMPORTED_MODULE_0___default().sanitize(dirty,{ALLOWED_TAGS:["p","br","strong","em","u","s","a","ul","ol","li","h1","h2","h3","h4","h5","h6","blockquote","code","pre","hr","table","thead","tbody","tr","th","td","img","div","span","figure","figcaption","video","audio","source"],ALLOWED_ATTR:["href","title","alt","src","class","id","rel","target","width","height","controls","autoplay","loop","muted","poster"],ALLOW_DATA_ATTR:!0,FORBID_ATTR:["onerror","onload","onclick","onmouseover"],FORBID_TAGS:["script","iframe","object","embed","form","input"]}))}}}]);