(self.webpackChunkcasaora=self.webpackChunkcasaora||[]).push([[53063],{"./messages lazy recursive ^\\.\\/.*\\.json$":(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./en.json":["./messages/en.json"],"./es.json":["./messages/es.json",81775]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return Promise.all(ids.slice(1).map(__webpack_require__.e)).then(()=>__webpack_require__.t(id,19))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id="./messages lazy recursive ^\\.\\/.*\\.json$",module.exports=webpackAsyncContext},"./node_modules/next-intl/dist/esm/production/server/react-client/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function e(e){return()=>{throw new Error(`\`${e}\` is not supported in Client Components.`)}}function t(...t){return e("getRequestConfig")}__webpack_require__.d(__webpack_exports__,{$:()=>i,M6:()=>t});e("getFormatter"),e("getNow"),e("getTimeZone"),e("getMessages"),e("getLocale");const i=e("getTranslations");e("setRequestLocale")},"./src/components/auth/sign-out-button.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>SignOutButton});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),index_min=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),HugeiconsIcon=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),auth=__webpack_require__("./src/lib/auth/index.ts"),server_client=__webpack_require__("./src/lib/supabase/server-client.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");var utils=__webpack_require__("./src/lib/utils.ts");function SignOutButton({className,showLabel=!0,isCollapsed=!1}){const[isPending,startTransition]=(0,react.useTransition)(),[isSigningOut,setIsSigningOut]=(0,react.useState)(!1),isLoading=isPending||isSigningOut;return(0,jsx_runtime.jsxs)("button",{"aria-label":isLoading?"Signing out...":"Sign out",className:(0,utils.cn)("flex items-center gap-3 rounded-lg px-3 py-2.5 font-medium text-[#94a3b8] text-sm transition-all hover:bg-[#f8fafc] hover:text-[#64748b]",isCollapsed&&"justify-center",isLoading&&"cursor-wait opacity-50",className),disabled:isLoading,onClick:()=>{setIsSigningOut(!0),startTransition(async()=>{try{await async function signOutAction(){const supabase=await(0,server_client.d)(),{error}=await supabase.auth.signOut();error&&console.error("[SignOut] Error signing out:",error),(0,navigation.redirect)(`${auth.Ei.signIn}?signedOut=true`)}()}catch(_error){setIsSigningOut(!1)}})},title:isCollapsed?isLoading?"Signing out...":"Sign out":void 0,type:"button",children:[(0,jsx_runtime.jsxs)("div",{className:(0,utils.cn)("relative",isLoading&&"animate-pulse"),children:[(0,jsx_runtime.jsx)(HugeiconsIcon.n,{className:"h-5 w-5 flex-shrink-0",icon:index_min.hc1}),isLoading&&(0,jsx_runtime.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,jsx_runtime.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-[#64748b] border-t-transparent"})})]}),showLabel&&!isCollapsed&&(0,jsx_runtime.jsx)("span",{className:(0,utils.cn)(isLoading&&"opacity-70"),children:isLoading?"Signing out...":"Sign out"})]})}try{SignOutButton.displayName="SignOutButton",SignOutButton.__docgenInfo={description:"Sign Out Button with loading state and visual feedback\nProvides a smooth logout experience with immediate visual response",displayName:"SignOutButton",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},showLabel:{defaultValue:{value:"true"},description:"",name:"showLabel",required:!1,type:{name:"boolean"}},isCollapsed:{defaultValue:{value:"false"},description:"",name:"isCollapsed",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/auth/sign-out-button.tsx#SignOutButton"]={docgenInfo:SignOutButton.__docgenInfo,name:"SignOutButton",path:"src/components/auth/sign-out-button.tsx#SignOutButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/customer/customer-mobile-sidebar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>CustomerMobileSidebar});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_customer_sidebar__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/customer/customer-sidebar.tsx");function CustomerMobileSidebar({unreadMessagesCount=0}){const[isOpen,setIsOpen]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(!1);return(0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(()=>(document.body.style.overflow=isOpen?"hidden":"",()=>{document.body.style.overflow=""}),[isOpen]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{"aria-label":"Open menu",className:"rounded-lg p-2 text-[#0f172a] transition-colors hover:bg-[#f8fafc] hover:text-[#0f172a] lg:hidden",onClick:()=>setIsOpen(!0),type:"button",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-6 w-6",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.XkB})}),isOpen&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"fixed inset-0 z-40 bg-[#0f172a]/50 lg:hidden",onClick:()=>setIsOpen(!1)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"fixed top-0 left-0 z-50 h-full transform transition-transform duration-300 lg:hidden "+(isOpen?"translate-x-0":"-translate-x-full"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_customer_sidebar__WEBPACK_IMPORTED_MODULE_4__.f,{onClose:()=>setIsOpen(!1),unreadMessagesCount})})]})}try{CustomerMobileSidebar.displayName="CustomerMobileSidebar",CustomerMobileSidebar.__docgenInfo={description:"",displayName:"CustomerMobileSidebar",props:{unreadMessagesCount:{defaultValue:{value:"0"},description:"",name:"unreadMessagesCount",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/customer/customer-mobile-sidebar.tsx#CustomerMobileSidebar"]={docgenInfo:CustomerMobileSidebar.__docgenInfo,name:"CustomerMobileSidebar",path:"src/components/customer/customer-mobile-sidebar.tsx#CustomerMobileSidebar"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/customer/customer-sidebar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>CustomerSidebar});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@hugeicons/core-free-icons/dist/esm/index.min.js"),_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@hugeicons/react/dist/esm/HugeiconsIcon.js"),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_components_auth_sign_out_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/components/auth/sign-out-button.tsx"),_i18n_routing__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/i18n/routing.ts");const navSections=[{title:"Overview",items:[{href:"/dashboard/customer",label:"Dashboard",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.yor},{href:"/dashboard/customer/bookings",label:"Bookings",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.TSf},{href:"/dashboard/customer/messages",label:"Messages",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.mjP}]},{title:"Services",items:[{href:"/professionals",label:"Find Professionals",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.Bbl},{href:"/dashboard/customer/favorites",label:"Favorites",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.dcc},{href:"/dashboard/customer/recurring-plans",label:"Recurring Plans",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.Hoz}]},{title:"Account",items:[{href:"/dashboard/customer/addresses",label:"Addresses",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.akv},{href:"/dashboard/customer/payments",label:"Payments",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.BFk},{href:"/dashboard/customer/settings",label:"Settings",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.ryW}]}];function CustomerSidebar({isCollapsed:controlledCollapsed,onToggleCollapse,onClose,unreadMessagesCount=0}){const pathname=(0,_i18n_routing__WEBPACK_IMPORTED_MODULE_5__.a8)(),[internalCollapsed,setInternalCollapsed]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(!1),isCollapsed=void 0!==controlledCollapsed?controlledCollapsed:internalCollapsed,handleToggle=onToggleCollapse||(()=>setInternalCollapsed(!internalCollapsed));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("aside",{className:"flex h-screen flex-col border-[#e2e8f0] border-r bg-[#f8fafc] transition-all duration-300 "+(isCollapsed?"w-16":"w-64"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex h-20 items-center border-[#e2e8f0] border-b px-6 "+(isCollapsed?"justify-center":"justify-between"),children:[!isCollapsed&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_i18n_routing__WEBPACK_IMPORTED_MODULE_5__.N_,{className:"flex items-center",href:"/",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"font-bold text-[#0f172a] text-lg tracking-tight",children:"CASAORA"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{"aria-label":isCollapsed?"Expand sidebar":"Collapse sidebar",className:"rounded-lg p-2 text-[#94a3b8] transition-colors hover:bg-[#f8fafc] hover:text-[#0f172a]",onClick:onClose||handleToggle,type:"button",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-5 w-5",icon:_hugeicons_core_free_icons__WEBPACK_IMPORTED_MODULE_1__.XkB})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("nav",{className:"flex-1 overflow-y-auto py-6",children:navSections.map((section,idx)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:idx>0?"mt-8":"",children:[!isCollapsed&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"mb-3 px-6",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"font-semibold text-[#94a3b8] text-xs uppercase tracking-wider",children:section.title})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"space-y-1 px-3",children:section.items.map(item=>{const active="/dashboard/customer"===(href=item.href)?pathname===href:pathname.startsWith(href);var href;const showBadge="/dashboard/customer/messages"===item.href&&unreadMessagesCount>0;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_i18n_routing__WEBPACK_IMPORTED_MODULE_5__.N_,{className:`flex items-center gap-3 rounded-lg px-3 py-2.5 font-medium text-sm transition-all ${active?"bg-[#f8fafc] text-[#64748b]":"text-[#94a3b8] hover:bg-[#f8fafc] hover:text-[#0f172a]"} ${isCollapsed?"justify-center":""}`,href:item.href,onClick:onClose,title:isCollapsed?item.label:void 0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_hugeicons_react__WEBPACK_IMPORTED_MODULE_2__.n,{className:"h-5 w-5 flex-shrink-0",icon:item.icon}),!isCollapsed&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"flex-1",children:item.label}),showBadge&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-[#64748b] px-1.5 font-semibold text-[#f8fafc] text-xs",children:unreadMessagesCount>99?"99+":unreadMessagesCount})]}),isCollapsed&&showBadge&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{className:"absolute top-1 right-1 h-2 w-2 rounded-full bg-[#64748b]"})]},item.href)})})]},section.title))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"border-[#e2e8f0] border-t p-3",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_auth_sign_out_button__WEBPACK_IMPORTED_MODULE_4__.c,{isCollapsed,showLabel:!isCollapsed})})]})}try{CustomerSidebar.displayName="CustomerSidebar",CustomerSidebar.__docgenInfo={description:"",displayName:"CustomerSidebar",props:{isCollapsed:{defaultValue:null,description:"",name:"isCollapsed",required:!1,type:{name:"boolean"}},onToggleCollapse:{defaultValue:null,description:"",name:"onToggleCollapse",required:!1,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"() => void"}},unreadMessagesCount:{defaultValue:{value:"0"},description:"",name:"unreadMessagesCount",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/customer/customer-sidebar.tsx#CustomerSidebar"]={docgenInfo:CustomerSidebar.__docgenInfo,name:"CustomerSidebar",path:"src/components/customer/customer-sidebar.tsx#CustomerSidebar"})}catch(__react_docgen_typescript_loader_error){}},"./src/i18n/routing.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{DT:()=>routing,N_:()=>Link,a8:()=>usePathname,rd:()=>useRouter});var next_intl_navigation__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next-intl/dist/esm/production/navigation/react-client/createNavigation.js");const routing=(0,__webpack_require__("./node_modules/next-intl/dist/esm/production/routing/defineRouting.js").A)({locales:["en","es"],defaultLocale:"en",localeCookie:{name:"NEXT_LOCALE",maxAge:31536e3}}),{Link,redirect,usePathname,useRouter}=(0,next_intl_navigation__WEBPACK_IMPORTED_MODULE_0__.A)(routing)},"./src/lib/auth/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Ei:()=>AUTH_ROUTES,bH:()=>getDashboardRouteForRole,Ht:()=>getSession,JR:()=>requireUser});const DASHBOARD_ROUTES={professional:"/dashboard/pro",customer:"/dashboard/customer",admin:"/admin"};function getDashboardRouteForRole(role,locale){const path=DASHBOARD_ROUTES[role]??"/dashboard";return locale?`/${locale}${path}`:path}const AUTH_ROUTES={signIn:"/auth/sign-in",signUp:"/auth/sign-up",signOut:"/auth/sign-out"};var headers=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/headers/index.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.js"),react_client=__webpack_require__("./node_modules/next-intl/dist/esm/production/server/react-client/index.js"),routing=__webpack_require__("./src/i18n/routing.ts");const locales=["en","es"],defaultLocale="en";(0,react_client.M6)(async({requestLocale})=>{const locale=await requestLocale,validatedLocale=locale&&locales.includes(locale)?locale:routing.DT.defaultLocale;return{locale:validatedLocale,messages:(await __webpack_require__("./messages lazy recursive ^\\.\\/.*\\.json$")(`./${validatedLocale}.json`)).default}});var server_client=__webpack_require__("./src/lib/supabase/server-client.ts");const LOCALE_PATTERN=/^\/?([a-z]{2})\//;async function getLocaleFromHeaders(){const headersList=await(0,headers.b3)(),match=(headersList.get("x-pathname")||headersList.get("referer")||"").match(LOCALE_PATTERN);return match?.[1]||defaultLocale}async function getSession(){const supabase=await(0,server_client.d)(),{data:{session}}=await supabase.auth.getSession();if(!session?.user)return{user:null};const appUser=await async function fetchProfileForUser(supabase,userId,roleFallback="customer"){const[{data:profile,error:profileError},{data:authUser,error:authError}]=await Promise.all([supabase.from("profiles").select("role, locale, onboarding_status").eq("id",userId).maybeSingle(),supabase.auth.getUser()]);if(profileError)return null;if(authError)return null;const user=authUser.user;if(!user)return null;const role=profile?.role??roleFallback,locale=profile?.locale??"en-US",onboardingStatus=profile?.onboarding_status??"application_pending";return{id:user.id,email:user.email??null,role,locale,onboardingStatus}}(supabase,session.user.id);return{user:appUser}}async function requireUser(options={}){const{allowedRoles,fallback}=options,{user}=await getSession();if(!user){const locale=await getLocaleFromHeaders(),redirectPath=fallback||function getAuthRoute(route,locale){const path=AUTH_ROUTES[route];return locale?`/${locale}${path}`:path}("signIn",locale);(0,navigation.redirect)(redirectPath)}if(allowedRoles&&!allowedRoles.includes(user.role)){const locale=await async function getUserLocale(user){return user?.locale?user.locale.split("-")[0]||defaultLocale:await getLocaleFromHeaders()}(user);(0,navigation.redirect)(getDashboardRouteForRole(user.role,locale))}return user}},"./src/lib/supabase/server-client.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>createSupabaseServerClient});var _supabase_ssr__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@supabase/ssr/dist/module/index.js"),next_cache__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/cache/index.js"),next_headers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/headers/index.js");async function createSupabaseServerClient(){(0,next_cache__WEBPACK_IMPORTED_MODULE_1__.Mo)();const supabaseUrl="https://hvnetxfsrtplextvtwfx.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh2bmV0eGZzcnRwbGV4dHZ0d2Z4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1ODc0NTEsImV4cCI6MjA3NzE2MzQ1MX0.7-N06om_ntUuGP1NZ0Zcqz01s975xJfiKno34aIW__o";const cookieStore=await(0,next_headers__WEBPACK_IMPORTED_MODULE_2__.UL)();return(0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_0__.createServerClient)(supabaseUrl,supabaseKey,{cookies:{getAll:()=>cookieStore.getAll(),setAll(cookiesToSet){try{cookiesToSet.forEach(({name,value,options})=>cookieStore.set(name,value,options))}catch{}}}})}},"./src/lib/utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function cn(...classes){return classes.filter(Boolean).join(" ")}__webpack_require__.d(__webpack_exports__,{cn:()=>cn})}}]);