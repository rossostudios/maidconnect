# MCP Server Configuration Guide

## Current Status ✅

Your MCP servers have been configured in:
`~/Library/Application Support/Claude/claude_desktop_config.json`

## Configured Servers

### ✅ Already Configured (No Action Needed)

1. **Supabase** - Database, auth, storage
2. **Context7** - Library documentation lookup  
3. **PostgreSQL** - Local database access

### ⚠️ Requires API Keys

#### 1. Exa (Search & Research)
```bash
# Get your Exa API key from: https://exa.ai/
# Then add it to the config file:
# "EXA_API_KEY": "your-exa-api-key-here"
```

#### 2. GitHub
```bash
# Create a Personal Access Token:
# 1. Go to https://github.com/settings/tokens
# 2. Click "Generate new token (classic)"
# 3. Select scopes: repo, read:org, read:user, read:project
# 4. Add it to the config:
# "GITHUB_PERSONAL_ACCESS_TOKEN": "ghp_your-token-here"
```

## Missing MCP Servers (Not Yet Available)

The following services don't have official MCP servers yet:

- **Vercel** - No official MCP server
- **PostHog** - No official MCP server
- **Stripe** - No official MCP server
- **Algolia** - No official MCP server
- **Sanity** - No official MCP server

### Workaround Options:

1. **Use REST APIs directly** - For PostHog, Stripe, etc., use web search or fetch tools
2. **Create custom MCP servers** - Build your own using @modelcontextprotocol/sdk
3. **Use existing integrations** - Your app already has these in src/lib/integrations/

## How to Add API Keys

### Option 1: Edit Config File Directly
```bash
# Open the config file
code ~/Library/Application\ Support/Claude/claude_desktop_config.json

# Add your API keys in the "env" sections
```

### Option 2: Use Script
```bash
# Create a helper script
cat > ~/add-mcp-key.sh << 'SCRIPT'
#!/bin/bash
SERVER=$1
KEY_NAME=$2
KEY_VALUE=$3

CONFIG_FILE="$HOME/Library/Application Support/Claude/claude_desktop_config.json"

# Use jq to update the config
jq ".mcpServers.$SERVER.env.$KEY_NAME = \"$KEY_VALUE\"" "$CONFIG_FILE" > tmp.json
mv tmp.json "$CONFIG_FILE"

echo "✅ Added $KEY_NAME to $SERVER"
SCRIPT

chmod +x ~/add-mcp-key.sh

# Example usage:
# ~/add-mcp-key.sh exa EXA_API_KEY "your-exa-key-here"
# ~/add-mcp-key.sh github GITHUB_PERSONAL_ACCESS_TOKEN "ghp_your-token"
```

## Testing Your Setup

### 1. Restart Claude Code
Close and reopen Claude Code for changes to take effect.

### 2. Test Each Server

#### Test Supabase:
Ask Claude: "List all tables in Supabase"

#### Test Exa (after adding API key):
Ask Claude: "Use Exa to research the latest trends in household service marketplaces"

#### Test GitHub (after adding token):
Ask Claude: "Show me the recent commits on the main branch"

#### Test Context7:
Ask Claude: "Get documentation for Next.js App Router"

#### Test PostgreSQL:
Ask Claude: "Show me the schema for the bookings table in PostgreSQL"

## Where Are Your Current Integrations?

You already have working integrations in your codebase:

```
src/lib/integrations/
├── posthog/          # Product analytics ✅
├── stripe/           # Payments ✅
├── sanity/           # CMS ✅
├── supabase/         # Database ✅
└── email/            # Email (Resend) ✅
```

**These work via your application** - You don't need MCP servers for them to function in your app. MCP servers are for Claude Code to interact with these services directly.

## Creating Custom MCP Servers (Advanced)

If you want MCP servers for PostHog, Stripe, etc., you can create them:

### 1. Install MCP SDK
```bash
cd ~/Desktop/casaora
npm install @modelcontextprotocol/sdk
```

### 2. Create Custom Server Structure
```
mcp-servers/
├── posthog/
│   ├── index.ts
│   ├── package.json
│   └── tools/
├── stripe/
│   └── ...
└── vercel/
    └── ...
```

### 3. Example: PostHog MCP Server
```typescript
// mcp-servers/posthog/index.ts
import { Server } from '@modelcontextprotocol/sdk/server/index.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';

const server = new Server({
  name: 'posthog-mcp',
  version: '1.0.0',
}, {
  capabilities: {
    tools: {},
  },
});

// Define tools
server.setRequestHandler('tools/list', async () => ({
  tools: [
    {
      name: 'get_insights',
      description: 'Get analytics insights from PostHog',
      inputSchema: {
        type: 'object',
        properties: {
          event: { type: 'string' },
        },
      },
    },
  ],
}));

// Start server
const transport = new StdioServerTransport();
await server.connect(transport);
```

### 4. Add to Config
```json
{
  "mcpServers": {
    "posthog-custom": {
      "command": "node",
      "args": ["~/Desktop/casaora/mcp-servers/posthog/index.js"],
      "env": {
        "POSTHOG_API_KEY": "phc_11wdEIg4PCjX2Kll5SP0jxHqCnePk3tEDscE2weaGvo",
        "POSTHOG_HOST": "https://us.i.posthog.com"
      }
    }
  }
}
```

## Quick Reference

### Available MCP Servers (Official)
- ✅ Supabase - @modelcontextprotocol/server-supabase
- ✅ GitHub - @modelcontextprotocol/server-github
- ✅ PostgreSQL - @modelcontextprotocol/server-postgres
- ✅ Context7 - @context7/mcp
- ✅ Exa - @exa/mcp-server-exa
- ✅ Puppeteer - @modelcontextprotocol/server-puppeteer
- ✅ Filesystem - @modelcontextprotocol/server-filesystem
- ✅ Memory - @modelcontextprotocol/server-memory

### Not Available (Yet)
- ❌ Vercel
- ❌ PostHog
- ❌ Stripe
- ❌ Algolia
- ❌ Sanity

## Support & Resources

- **MCP Documentation**: https://modelcontextprotocol.io/
- **MCP SDK**: https://github.com/modelcontextprotocol/sdk
- **Official Servers**: https://github.com/modelcontextprotocol/servers
- **Community Servers**: https://github.com/punkpeye/awesome-mcp-servers

## Troubleshooting

### "Server not responding"
1. Check npx is installed: `which npx`
2. Try running manually: `npx -y @exa/mcp-server-exa`
3. Restart Claude Code

### "Authentication failed"
1. Verify API keys are correct
2. Check API key permissions
3. Test API key with curl/Postman first

### "Tool not available"
1. Restart Claude Code after config changes
2. Check server name matches exactly
3. Look for errors in Claude Code logs

---

**Last Updated**: January 12, 2025
